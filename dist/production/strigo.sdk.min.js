(()=>{var Me="strigo-sdk",Ge="strigo.io",Ne="localhost:3000",ze=["strigo-exercises"],De=["orig-iframe"],fe=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"/></svg>
`,Fe=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M224 480c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25l192-192c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l169.4 169.4c12.5 12.5 12.5 32.75 0 45.25C240.4 476.9 232.2 480 224 480z"/></svg>
`,P="https://cdn.statically.io/gh/strigo/strigo-sdk";function j(){return document.getElementsByTagName("head")[0]}function Ve(){document.open(),document.close()}function Pe(){let e=document.createElement("div");return e.className="strigo-main",document.body.appendChild(e),e}function q(e){let{url:t,parentElement:o}=e,s=document.createElement("link");s.rel="stylesheet",s.href=t,o.appendChild(s)}function de(e){let{url:t,parentElement:o,classNames:s,id:l}=e,g=document.createElement("iframe");return g.classList.add(...s),g.id=l,g.src=t,o.appendChild(g),g}function ke(){location.reload()}function We(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function He(){return We()?[window.screen.width,window.screen.width]:[window.screen.width/2,window.screen.width]}function Be(){return We()?[0,0]:[window.screen.width*.25,0]}function Ct(){let e=new XMLHttpRequest;e.open("GET",window.document.location.href,!1),e.send(null);let o=e.getAllResponseHeaders().toLowerCase().split(`\r
`);for(let s of o)if(s.includes("x-frame-options")){let l=s.split(":");if(l&&l.length>1)return l[1].trim()!=="deny"}return!0}function Ue(e){return e&&e==="dynamic"?Ct()?"iframe":"overlay":e}function Ye(e){let t=function(){let E=document.getElementById("strigo-widget"),u=E.classList.contains("slide-in");E.classList.toggle("slide-in"),setTimeout(()=>{let R=document.getElementById("strigo-arrow");R.innerHTML=u?Fe:fe},300)},o=document.createElement("div");o.className="strigo-arrow",o.id="strigo-arrow",o.innerHTML=fe;let s=document.createElement("div");s.className="strigo-collapse-button",s.id="strigo-toggle",s.appendChild(o);let l=document.createElement("div");l.className="strigo-collapse-div",l.onclick=()=>{t()},l.appendChild(s);let g=document.createElement("iframe");g.className="strigo-iframe",g.id="strigo-exercises",g.src=e;let d=document.createElement("div");return d.className="strigo-widget",d.id="strigo-widget",d.appendChild(l),d.appendChild(g),document.body.appendChild(d),g}var $e=function(){document.getElementById("strigo-widget").remove()},Ke=function(){let e=document.getElementById("strigo-widget");e.classList.contains("slide-in")||e.classList.add("slide-in")};function _t(e){let t={};for(let[o,s]of e)t[o]=s;return t}function Je(){let{host:e,pathname:t,href:o,origin:s,search:l}=window.location;return{host:e,pathName:t,href:o,origin:s,search:l,params:bt(l)}}function bt(e){let o=new URLSearchParams(e).entries();return _t(o)}function X(e){let{subDomain:t,token:o,webApiKey:s,development:l}=e;return l?`http://${Ne}/academy/courses?token=${o.token}&webApiKey=${s}`:`https://${t}.${Ge}/academy/courses?token=${o.token}&webApiKey=${s}`}function je(){let e=document.getElementById(Me);return{webApiKey:e?.getAttribute("data-web-api-key")||"",subDomain:e?.getAttribute("data-subdomain")||"",selectedWidgetFlavor:e?.getAttribute("data-layout-flavor")||"dynamic"}}function qe(e,t){return e?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:t?`${P}@${t}/dist/production/styles/strigo.min.css`:`${P}@latest/dist/production/styles/strigo.min.css`}function Xe(e,t){return e?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo-widget.css`:t?`${P}@${t}/dist/production/styles/strigo-widget.min.css`:`${P}@latest/dist/production/styles/strigo-widget.min.css`}var c={log(e,t,o){try{let s=`${new Date().toISOString()} - ${t}`;console[e](s,o?`
${JSON.stringify(o)}`:"")}catch(s){console.log("Logging error:",s)}},debug(e,t={}){this.log("debug",e,t)},info(e,t={}){this.log("info",e,t)},warn(e,t={}){this.log("warn",e,t)},error(e,t={}){this.log("error",e,t)}};function W(e,t){try{return JSON.parse(window[e].getItem(t))}catch(o){return c.error(o),null}}function Z(e,t,o){try{return window[e].setItem(t,JSON.stringify(o)),o}catch(s){return c.error(s),null}}function pe(e,t,o,s){try{let l=W(e,t);if(!l)throw new Error("Can't find initial state");let g={...l,[o]:s};return window[e].setItem(t,JSON.stringify(g)),g}catch(l){return c.error(l),null}}function Q(e,t){try{window[e].removeItem(t)}catch(o){c.error(o)}}function Qe(e){return Z("localStorage","strigoConfig",e)}function I(){return W("localStorage","strigoConfig")}function et(){Q("localStorage","strigoConfig")}function tt(e){return Z("sessionStorage","strigoSession",e)}function ee(){return we()?.isPanelOpen}function y(){return we()?.widgetFlavor}function we(){return W("sessionStorage","strigoSession")}function H(e,t){return pe("sessionStorage","strigoSession",e,t)}function rt(e){return we()?.[e]}function nt(){Q("sessionStorage","strigoSession")}function he(){H("isPanelOpen",!1)}window.onunload=function(){he()};function ot(){try{let e=te();if(e)return c.debug("Events storage already exists"),e;let t={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),t}catch(e){return c.error("Init events storage error",{error:e}),null}}function te(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(e){return c.error("Get events storage error",{error:e}),null}}function it(e){try{let t=te();if(!t)throw new Error("Can't find initial state");let o=JSON.stringify(t);if(t.events.push(e),window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),y()==="overlay"){let s=new CustomEvent("overlay-widget-event",{bubbles:!0,detail:{key:"strigoEvents",oldValue:o,newValue:JSON.stringify(t)}});window.dispatchEvent(s)}return t}catch(t){return c.error("Push event to storage error",{error:t}),null}}function st(){try{let e=te();if(!e)throw new Error("Can't find events storage");let t=e.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),t}catch(e){return c.error("Pop event from storage error",{error:e}),null}}function Oe(){try{let e=te();if(!e)throw new Error("Can't find events storage");return e.events.pop()}catch(e){return c.error("Get event from storage error",{error:e}),null}}var v=typeof window!="undefined"?window:null,ye=v===null,U=ye?void 0:v.document,w="addEventListener",h="removeEventListener",Te="getBoundingClientRect",B="_a",O="_b",A="_c",re="horizontal",T=function(){return!1},Gt=ye?"calc":["","-webkit-","-moz-","-o-"].filter(function(e){var t=U.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length}).shift()+"calc",lt=function(e){return typeof e=="string"||e instanceof String},ct=function(e){if(lt(e)){var t=U.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},m=function(e,t,o){var s=e[t];return s!==void 0?s:o},ne=function(e,t,o,s){if(t){if(s==="end")return 0;if(s==="center")return e/2}else if(o){if(s==="start")return 0;if(s==="center")return e/2}return e},Nt=function(e,t){var o=U.createElement("div");return o.className="gutter gutter-"+t,o},zt=function(e,t,o){var s={};return lt(t)?s[e]=t:s[e]=Gt+"("+t+"% - "+o+"px)",s},Dt=function(e,t){var o;return o={},o[e]=t+"px",o},Ft=function(e,t){if(t===void 0&&(t={}),ye)return{};var o=e,s,l,g,d,E,u;Array.from&&(o=Array.from(o));var R=ct(o[0]),L=R.parentNode,z=getComputedStyle?getComputedStyle(L):null,D=z?z.flexDirection:null,x=m(t,"sizes")||o.map(function(){return 100/o.length}),b=m(t,"minSize",100),ae=Array.isArray(b)?b:o.map(function(){return b}),ce=m(t,"maxSize",1/0),vt=Array.isArray(ce)?ce:o.map(function(){return ce}),Et=m(t,"expandToMin",!1),F=m(t,"gutterSize",10),Y=m(t,"gutterAlign","center"),le=m(t,"snapOffset",30),wt=Array.isArray(le)?le:o.map(function(){return le}),ge=m(t,"dragInterval",1),M=m(t,"direction",re),ue=m(t,"cursor",M===re?"col-resize":"row-resize"),ht=m(t,"gutter",Nt),Ae=m(t,"elementStyle",zt),Ot=m(t,"gutterStyle",Dt);M===re?(s="width",l="clientX",g="left",d="right",E="clientWidth"):M==="vertical"&&(s="height",l="clientY",g="top",d="bottom",E="clientHeight");function V(i,r,n,a){var S=Ae(s,r,n,a);Object.keys(S).forEach(function(f){i.style[f]=S[f]})}function Tt(i,r,n){var a=Ot(s,r,n);Object.keys(a).forEach(function(S){i.style[S]=a[S]})}function $(){return u.map(function(i){return i.size})}function Re(i){return"touches"in i?i.touches[0][l]:i[l]}function xe(i){var r=u[this.a],n=u[this.b],a=r.size+n.size;r.size=i/this.size*a,n.size=a-i/this.size*a,V(r.element,r.size,this[O],r.i),V(n.element,n.size,this[A],n.i)}function yt(i){var r,n=u[this.a],a=u[this.b];!this.dragging||(r=Re(i)-this.start+(this[O]-this.dragOffset),ge>1&&(r=Math.round(r/ge)*ge),r<=n.minSize+n.snapOffset+this[O]?r=n.minSize+this[O]:r>=this.size-(a.minSize+a.snapOffset+this[A])&&(r=this.size-(a.minSize+this[A])),r>=n.maxSize-n.snapOffset+this[O]?r=n.maxSize+this[O]:r<=this.size-(a.maxSize-a.snapOffset+this[A])&&(r=this.size-(a.maxSize+this[A])),xe.call(this,r),m(t,"onDrag",T)($()))}function Ce(){var i=u[this.a].element,r=u[this.b].element,n=i[Te](),a=r[Te]();this.size=n[s]+a[s]+this[O]+this[A],this.start=n[g],this.end=n[d]}function Lt(i){if(!getComputedStyle)return null;var r=getComputedStyle(i);if(!r)return null;var n=i[E];return n===0?null:(M===re?n-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight):n-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),n)}function _e(i){var r=Lt(L);if(r===null||ae.reduce(function(f,p){return f+p},0)>r)return i;var n=0,a=[],S=i.map(function(f,p){var _=r*f/100,K=ne(F,p===0,p===i.length-1,Y),J=ae[p]+K;return _<J?(n+=J-_,a.push(0),J):(a.push(_-J),_)});return n===0?i:S.map(function(f,p){var _=f;if(n>0&&a[p]-n>0){var K=Math.min(n,a[p]-n);n-=K,_=f-K}return _/r*100})}function It(){var i=this,r=u[i.a].element,n=u[i.b].element;i.dragging&&m(t,"onDragEnd",T)($()),i.dragging=!1,v[h]("mouseup",i.stop),v[h]("touchend",i.stop),v[h]("touchcancel",i.stop),v[h]("mousemove",i.move),v[h]("touchmove",i.move),i.stop=null,i.move=null,r[h]("selectstart",T),r[h]("dragstart",T),n[h]("selectstart",T),n[h]("dragstart",T),r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",i.gutter.style.cursor="",i.parent.style.cursor="",U.body.style.cursor=""}function At(i){if(!("button"in i&&i.button!==0)){var r=this,n=u[r.a].element,a=u[r.b].element;r.dragging||m(t,"onDragStart",T)($()),i.preventDefault(),r.dragging=!0,r.move=yt.bind(r),r.stop=It.bind(r),v[w]("mouseup",r.stop),v[w]("touchend",r.stop),v[w]("touchcancel",r.stop),v[w]("mousemove",r.move),v[w]("touchmove",r.move),n[w]("selectstart",T),n[w]("dragstart",T),a[w]("selectstart",T),a[w]("dragstart",T),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",a.style.userSelect="none",a.style.webkitUserSelect="none",a.style.MozUserSelect="none",a.style.pointerEvents="none",r.gutter.style.cursor=ue,r.parent.style.cursor=ue,U.body.style.cursor=ue,Ce.call(r),r.dragOffset=Re(i)-r.end}}x=_e(x);var C=[];u=o.map(function(i,r){var n={element:ct(i),size:x[r],minSize:ae[r],maxSize:vt[r],snapOffset:wt[r],i:r},a;if(r>0&&(a={a:r-1,b:r,dragging:!1,direction:M,parent:L},a[O]=ne(F,r-1===0,!1,Y),a[A]=ne(F,!1,r===o.length-1,Y),D==="row-reverse"||D==="column-reverse")){var S=a.a;a.a=a.b,a.b=S}if(r>0){var f=ht(r,M,n.element);Tt(f,F,r),a[B]=At.bind(a),f[w]("mousedown",a[B]),f[w]("touchstart",a[B]),L.insertBefore(f,n.element),a.gutter=f}return V(n.element,n.size,ne(F,r===0,r===o.length-1,Y),r),r>0&&C.push(a),n});function be(i){var r=i.i===C.length,n=r?C[i.i-1]:C[i.i];Ce.call(n);var a=r?n.size-i.minSize-n[A]:i.minSize+n[O];xe.call(n,a)}u.forEach(function(i){var r=i.element[Te]()[s];r<i.minSize&&(Et?be(i):i.minSize=r)});function Rt(i){var r=_e(i);r.forEach(function(n,a){if(a>0){var S=C[a-1],f=u[S.a],p=u[S.b];f.size=r[a-1],p.size=n,V(f.element,f.size,S[O],f.i),V(p.element,p.size,S[A],p.i)}})}function xt(i,r){C.forEach(function(n){if(r!==!0?n.parent.removeChild(n.gutter):(n.gutter[h]("mousedown",n[B]),n.gutter[h]("touchstart",n[B])),i!==!0){var a=Ae(s,n.a.size,n[O]);Object.keys(a).forEach(function(S){u[n.a].element.style[S]="",u[n.b].element.style[S]=""})}})}return{setSizes:Rt,getSizes:$,collapse:function(r){be(u[r])},destroy:xt,parent:L,pairs:C}},gt=Ft;var Vt=`
<div class="circle-loader">
  <svg class="circular" viewBox="25 25 50 50">
  <circle
    class="path"
    cx="50"
    cy="50"
    r="20"
    fill="none"
    stroke-width="2"
    stroke-miterlimit="10"
  />
  </svg>
</div>
`;function ut(){H("isLoading",!0);let e=document.createElement("div");e.className="strigo-loader",e.innerHTML=Vt,document.body.appendChild(e)}function ft(){switch(y()){case"iframe":{let e=document.querySelector(".strigo-loader"),t=setInterval(()=>{e.style.opacity||(e.style.opacity="1");let o=parseFloat(e.style.opacity);o>0?e.style.opacity=(o-.1).toString():(H("isLoading",!1),e.style.pointerEvents="none",clearInterval(t))},200);break}case"overlay":{H("isLoading",!1),document.getElementById("strigo-widget").classList.add("slide-in"),document.getElementById("strigo-widget").classList.add("loaded");break}default:{c.error("widgetFlavor is not supported - loader");break}}}function dt(){return!!rt("isLoading")}function Le(){let e=Oe();if(e){c.info("Posting event",e),window.frames[0].postMessage(e,"*");let t=st();e.eventName!==t.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:e,poppedEvent:t})}}function St(){for(;Oe();)Le()}var N={init:function(){c.info("widget - overlay - init");let e=I();e&&window.Strigo.setup(e)},setup:function({development:e,version:t}){c.info("widget - overlay - setup"),q({parentElement:j(),url:Xe(e,t)});let o=Ye(X(I()));ie(o),oe()},shutdown:function(){c.info("widget - overlay - shutdown"),$e(),he()},open:function(){Ke()}};function pt({key:e,oldValue:t,newValue:o}){if(e!=="strigoEvents")return;let s=JSON.parse(o)?.events,l=JSON.parse(t)?.events;s.filter(({eventName:d})=>!l.some(({eventName:E})=>d===E)).length>0&&Le()}function oe(){switch(window.addEventListener("message",e=>{if(!(!e||!e.data))switch(e.data){case"close":{window.Strigo&&window.Strigo.shutdown();break}case"challenge-success":{c.info("Challenge event success received"),y()==="overlay"&&N.open();break}default:break}},!1),y()){case"iframe":{window.addEventListener("storage",pt);break}case"overlay":{window.addEventListener("overlay-widget-event",e=>{pt(e?.detail)});break}default:break}}function ie(e){e.addEventListener("load",()=>{dt()&&ft(),St()})}var se={init:function(){let e;if(ee())c.info("SUBSCRIBER SDK"),e="CHILD",window.dispatchEvent(new Event("strigo-opened"));else{c.info("HOST SDK"),e="PARENT";let t=I();t&&window.Strigo.setup(t)}return e},setup:function({development:e,version:t}){c.info("widget - iframe - setup"),Ve(),q({parentElement:j(),url:qe(e,t)}),ut();let o=Pe(),s=de({parentElement:o,url:X(I()),classNames:ze,id:"strigo-exercises"});de({parentElement:o,url:I().initSite.href,classNames:De,id:"original-site"}),gt(["#strigo-exercises","#original-site"],{sizes:[25,75],maxSize:He(),minSize:Be(),gutterSize:2}),ie(s),oe()},shutdown:function(){c.info("widget - iframe - shutdown"),ke()}};var Ie;(g=>{function t(){if(c.info("init called"),ot(),!window.Strigo?.initialized)switch(window.Strigo.initialized=!0,y()){case"iframe":{g.SDKType=se.init();break}case"overlay":{g.SDKType="OVERLAY",N.init();break}default:break}}g.init=t;function o(d){if(g.SDKType==="CHILD"||g.SDKType==="OVERLAY"&&ee()){c.info("panel is already opened");return}c.info("setup started");let{email:E,token:u,development:R=!1,version:L}=d,{webApiKey:z,subDomain:D,selectedWidgetFlavor:x}=je();if(!R&&(!E||!u||!z||!D||!x)){c.error("Please provide setup data");return}Qe({email:E,initSite:Je(),token:u,webApiKey:z,subDomain:D,development:R,version:L,selectedWidgetFlavor:x});let b=Ue(x);switch(tt({currentUrl:I().initSite.href,isPanelOpen:!0,isLoading:!0,widgetFlavor:b}),b){case"iframe":{se.setup({version:L,development:R});break}case"overlay":{N.setup({version:L,development:R});break}default:{c.error("widgetFlavor is not supported - setup");break}}c.info("setup finished")}g.setup=o;function s(){if(c.info("shutdown called"),g.SDKType==="CHILD")return window.parent.postMessage("close","*");let d=y();switch(et(),nt(),d){case"iframe":{se.shutdown();break}case"overlay":{N.shutdown();break}default:{c.error("widgetFlavor is not supported");break}}}g.shutdown=s;function l(d){it({eventName:d}),c.debug("sendEvent called",{eventName:d})}g.sendEvent=l})(Ie||={});window.Strigo=Ie;window.Strigo.init();})();
