(()=>{var _e="strigo-sdk",De="strigo.io",Me="localhost:3000",Ne=["strigo-exercises"],Ge=["orig-iframe"],ge=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"/></svg>
`,ze=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M224 480c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25l192-192c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l169.4 169.4c12.5 12.5 12.5 32.75 0 45.25C240.4 476.9 232.2 480 224 480z"/></svg>
`,M="https://cdn.jsdelivr.net/gh/strigo/strigo-sdk";function kt(t){let e={};for(let[r,o]of t)e[r]=o;return e}function Ht(t){let r=new URLSearchParams(t).entries();return kt(r)}function be(){let{host:t,pathname:e,href:r,origin:o,search:a}=window.location;return{host:t,pathName:e,href:r,origin:o,search:a,params:Ht(a)}}function H(t){let{subDomain:e,user:r,webApiKey:o,development:a}=t;return a?`http://${Me}/academy/courses?token=${r.token.token}&webApiKey=${o}`:`https://${e}.${De}/academy/courses?token=${r.token.token}&webApiKey=${o}`}function Pe(t){let e=new URL(t);return e.searchParams.set("strigoChildIframe","true"),e.toString()}function Fe(){return window.location.search.includes("strigoChildIframe")}function We(){let t=document.getElementById(_e);return{webApiKey:t?.getAttribute("data-web-api-key")||"",subDomain:t?.getAttribute("data-subdomain")||"",selectedWidgetFlavor:t?.getAttribute("data-layout-flavor")||"dynamic"}}function Ve(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:e?`${M}@${e}/dist/production/styles/strigo.min.css`:`${M}@master/dist/production/styles/strigo.min.css`}function ke(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo-widget.css`:e?`${M}@${e}/dist/production/styles/strigo-widget.min.css`:`${M}@master/dist/production/styles/strigo-widget.min.css`}var He=class{constructor(e){this.url=e?.url}setup(e){this.url=e.url}logToRemote(e,r,o){return fetch(this.url,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({level:e,message:r,context:o})}).then(a=>{a.ok||console.warn("Logging to Strigo failed",{result:a})}).catch(a=>{console.warn("Logging to Strigo failed",{err:a})})}logToConsole(e,r,o){let a=`${new Date().toISOString()} - ${r}`;console[e](a,o?`
${JSON.stringify(o)}`:"")}getDefaultContext(){let e=p();if(!e)return{};let{user:r,subDomain:o,initSite:a,development:c,version:E,selectedWidgetFlavor:O}=e;return{token:r?.token.token,initSite:a?.href,subDomain:o,development:c,version:E,selectedWidgetFlavor:O}}log(e,r,o){let a={...this.getDefaultContext(),...o};try{this.url&&!p()?.development&&this.logToRemote(e,r,a),this.logToConsole(e,`Academy - ${r}`,a)}catch(c){console.log("Logging error:",{err:c})}}debug(e,r={}){this.log("debug",e,r)}info(e,r={}){this.log("info",e,r)}warn(e,r={}){this.log("warn",e,r)}error(e,r={}){this.log("error",e,r)}},l=new He;function G(t,e){try{return JSON.parse(window[t].getItem(e))}catch(r){return l.error("get storage data error",{err:r}),null}}function z(t,e,r){try{return window[t].setItem(e,JSON.stringify(r)),r}catch(o){return l.error("setup storage error",{err:o}),null}}function de(t,e,r,o){try{let a=G(t,e);if(!a)throw new Error("Can't find initial state");let c={...a,[r]:o};return window[t].setItem(e,JSON.stringify(c)),c}catch(a){return l.error("set storage value error",{err:a}),null}}function ue(t,e){try{window[t].removeItem(e)}catch(r){l.error("clear storage error",{err:r})}}function p(){return G("localStorage","strigoConfig")}function Ue(t){let e=p();return z("localStorage","strigoConfig",{...t,...e})}function Be(t){let e=p();return z("localStorage","strigoConfig",{...e,...t})}function Ye(t){return p()?.[t]}async function $e(t,e){try{let o=await fetch(`${e?"http://localhost:3000":"https://app.strigo.io"}/api/internal/academy/v1/config`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`}});if(!o.ok)throw new Error(`Failed to fetch remote configuration: ${o.statusText}`);return(await o.json()).data}catch(r){return l.warn("Error fetching configuration from Strigo",{err:r}),null}}function Je(t){return z("sessionStorage","strigoSession",t)}function me(){return G("sessionStorage","strigoSession")}function je(){return me()?.isPanelOpen}function R(){return me()?.widgetFlavor}function Se(t,e){return de("sessionStorage","strigoSession",t,e)}function qe(t){return me()?.[t]}function Xe(){ue("sessionStorage","strigoSession")}function Ze(){Se("isPanelOpen",!1)}function U(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(t){return l.error("Get events storage error",{error:t}),null}}function Qe(){try{let t=U();if(t)return l.debug("Events storage already exists"),t;let e={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),e}catch(t){return l.error("Init events storage error",{error:t}),null}}function et(t){try{let e=U();if(!e)throw new Error("Can't find initial state");let r=JSON.stringify(e);if(e.events.push(t),window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),R()==="overlay"){let o=new CustomEvent("overlay-widget-event",{bubbles:!0,detail:{key:"strigoEvents",oldValue:r,newValue:JSON.stringify(e)}});window.dispatchEvent(o)}return e}catch(e){return l.error("Push event to storage error",{error:e}),null}}function tt(){try{let t=U();if(!t)throw new Error("Can't find events storage");let e=t.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),e}catch(t){return l.error("Pop event from storage error",{error:t}),null}}function ve(){try{let t=U();if(!t)throw new Error("Can't find events storage");return t.events.pop()}catch(t){return l.error("Get event from storage error",{error:t}),null}}function B(){return document.getElementsByTagName("head")[0]}function nt(){document.open(),document.close()}function ot(){let t=document.createElement("div");return t.className="strigo-main",document.body.appendChild(t),t}function Y(t){let{url:e,parentElement:r}=t,o=document.createElement("link");o.rel="stylesheet",o.href=e,r.appendChild(o)}function Ee(t){let{url:e,parentElement:r,classNames:o,id:a}=t,c=document.createElement("iframe");return c.classList.add(...o),c.id=a,c.src=e,r.appendChild(c),c}function it(){location.reload()}function st(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function at(){return st()?[window.screen.width,window.screen.width]:[window.screen.width/2,window.screen.width]}function gt(){return st()?[0,0]:[window.screen.width*.25,0]}function lt(){let t=new XMLHttpRequest;t.open("GET",window.document.location.href,!1),t.send(null);let r=t.getAllResponseHeaders().toLowerCase().split(`\r
`);for(let o of r)if(o.includes("x-frame-options")){let a=o.split(":");if(a&&a.length>1)return a[1].trim()!=="deny"}return!0}function Kt(){let t=document.getElementById("strigo-widget"),e=t.classList.contains("slide-in");t.classList.toggle("slide-in"),setTimeout(()=>{let r=document.getElementById("strigo-arrow");r.innerHTML=e?ze:ge},300)}function ct(t){let e=document.createElement("div");e.className="strigo-arrow",e.id="strigo-arrow",e.innerHTML=ge;let r=document.createElement("div");r.className="strigo-collapse-button",r.id="strigo-toggle",r.appendChild(e);let o=document.createElement("div");o.className="strigo-collapse-div",o.onclick=()=>{Kt()},o.appendChild(r);let a=document.createElement("iframe");a.className="strigo-iframe",a.id="strigo-exercises",a.src=t;let c=document.createElement("div");return c.id="strigo-widget",c.appendChild(o),c.appendChild(a),document.body.appendChild(c),a}function dt(){document.getElementById("strigo-widget").remove()}function ut(){let t=document.getElementById("strigo-widget");t.classList.contains("slide-in")||t.classList.add("slide-in")}var v=typeof window!="undefined"?window:null,we=v===null,P=we?void 0:v.document,h="addEventListener",w="removeEventListener",he="getBoundingClientRect",b="_a",y="_b",I="_c",$="horizontal",T=function(){return!1},Ut=we?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var e=P.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length}).shift()+"calc",St=function(t){return typeof t=="string"||t instanceof String},mt=function(t){if(St(t)){var e=P.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},m=function(t,e,r){var o=t[e];return o!==void 0?o:r},J=function(t,e,r,o){if(e){if(o==="end")return 0;if(o==="center")return t/2}else if(r){if(o==="start")return 0;if(o==="center")return t/2}return t},Bt=function(t,e){var r=P.createElement("div");return r.className="gutter gutter-"+e,r},Yt=function(t,e,r){var o={};return St(e)?o[t]=e:o[t]=Ut+"("+e+"% - "+r+"px)",o},$t=function(t,e){var r;return r={},r[t]=e+"px",r},Jt=function(t,e){if(e===void 0&&(e={}),we)return{};var r=t,o,a,c,E,O,d;Array.from&&(r=Array.from(r));var ee=mt(r[0]),A=ee.parentNode,Te=getComputedStyle?getComputedStyle(A):null,Oe=Te?Te.flexDirection:null,te=m(e,"sizes")||r.map(function(){return 100/r.length}),re=m(e,"minSize",100),ne=Array.isArray(re)?re:r.map(function(){return re}),oe=m(e,"maxSize",1/0),At=Array.isArray(oe)?oe:r.map(function(){return oe}),_t=m(e,"expandToMin",!1),_=m(e,"gutterSize",10),F=m(e,"gutterAlign","center"),ie=m(e,"snapOffset",30),Dt=Array.isArray(ie)?ie:r.map(function(){return ie}),se=m(e,"dragInterval",1),x=m(e,"direction",$),ae=m(e,"cursor",x===$?"col-resize":"row-resize"),Mt=m(e,"gutter",Bt),Ie=m(e,"elementStyle",Yt),Nt=m(e,"gutterStyle",$t);x===$?(o="width",a="clientX",c="left",E="right",O="clientWidth"):x==="vertical"&&(o="height",a="clientY",c="top",E="bottom",O="clientHeight");function D(s,n,i,g){var f=Ie(o,n,i,g);Object.keys(f).forEach(function(u){s.style[u]=f[u]})}function Gt(s,n,i){var g=Nt(o,n,i);Object.keys(g).forEach(function(f){s.style[f]=g[f]})}function W(){return d.map(function(s){return s.size})}function Le(s){return"touches"in s?s.touches[0][a]:s[a]}function Ce(s){var n=d[this.a],i=d[this.b],g=n.size+i.size;n.size=s/this.size*g,i.size=g-s/this.size*g,D(n.element,n.size,this[y],n.i),D(i.element,i.size,this[I],i.i)}function zt(s){var n,i=d[this.a],g=d[this.b];!this.dragging||(n=Le(s)-this.start+(this[y]-this.dragOffset),se>1&&(n=Math.round(n/se)*se),n<=i.minSize+i.snapOffset+this[y]?n=i.minSize+this[y]:n>=this.size-(g.minSize+g.snapOffset+this[I])&&(n=this.size-(g.minSize+this[I])),n>=i.maxSize-i.snapOffset+this[y]?n=i.maxSize+this[y]:n<=this.size-(g.maxSize-g.snapOffset+this[I])&&(n=this.size-(g.maxSize+this[I])),Ce.call(this,n),m(e,"onDrag",T)(W()))}function xe(){var s=d[this.a].element,n=d[this.b].element,i=s[he](),g=n[he]();this.size=i[o]+g[o]+this[y]+this[I],this.start=i[c],this.end=i[E]}function bt(s){if(!getComputedStyle)return null;var n=getComputedStyle(s);if(!n)return null;var i=s[O];return i===0?null:(x===$?i-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight):i-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),i)}function Re(s){var n=bt(A);if(n===null||ne.reduce(function(u,S){return u+S},0)>n)return s;var i=0,g=[],f=s.map(function(u,S){var C=n*u/100,V=J(_,S===0,S===s.length-1,F),k=ne[S]+V;return C<k?(i+=k-C,g.push(0),k):(g.push(C-k),C)});return i===0?s:f.map(function(u,S){var C=u;if(i>0&&g[S]-i>0){var V=Math.min(i,g[S]-i);i-=V,C=u-V}return C/n*100})}function Pt(){var s=this,n=d[s.a].element,i=d[s.b].element;s.dragging&&m(e,"onDragEnd",T)(W()),s.dragging=!1,v[w]("mouseup",s.stop),v[w]("touchend",s.stop),v[w]("touchcancel",s.stop),v[w]("mousemove",s.move),v[w]("touchmove",s.move),s.stop=null,s.move=null,n[w]("selectstart",T),n[w]("dragstart",T),i[w]("selectstart",T),i[w]("dragstart",T),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",i.style.userSelect="",i.style.webkitUserSelect="",i.style.MozUserSelect="",i.style.pointerEvents="",s.gutter.style.cursor="",s.parent.style.cursor="",P.body.style.cursor=""}function Ft(s){if(!("button"in s&&s.button!==0)){var n=this,i=d[n.a].element,g=d[n.b].element;n.dragging||m(e,"onDragStart",T)(W()),s.preventDefault(),n.dragging=!0,n.move=zt.bind(n),n.stop=Pt.bind(n),v[h]("mouseup",n.stop),v[h]("touchend",n.stop),v[h]("touchcancel",n.stop),v[h]("mousemove",n.move),v[h]("touchmove",n.move),i[h]("selectstart",T),i[h]("dragstart",T),g[h]("selectstart",T),g[h]("dragstart",T),i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.MozUserSelect="none",i.style.pointerEvents="none",g.style.userSelect="none",g.style.webkitUserSelect="none",g.style.MozUserSelect="none",g.style.pointerEvents="none",n.gutter.style.cursor=ae,n.parent.style.cursor=ae,P.body.style.cursor=ae,xe.call(n),n.dragOffset=Le(s)-n.end}}te=Re(te);var L=[];d=r.map(function(s,n){var i={element:mt(s),size:te[n],minSize:ne[n],maxSize:At[n],snapOffset:Dt[n],i:n},g;if(n>0&&(g={a:n-1,b:n,dragging:!1,direction:x,parent:A},g[y]=J(_,n-1===0,!1,F),g[I]=J(_,!1,n===r.length-1,F),Oe==="row-reverse"||Oe==="column-reverse")){var f=g.a;g.a=g.b,g.b=f}if(n>0){var u=Mt(n,x,i.element);Gt(u,_,n),g[b]=Ft.bind(g),u[h]("mousedown",g[b]),u[h]("touchstart",g[b]),A.insertBefore(u,i.element),g.gutter=u}return D(i.element,i.size,J(_,n===0,n===r.length-1,F),n),n>0&&L.push(g),i});function Ae(s){var n=s.i===L.length,i=n?L[s.i-1]:L[s.i];xe.call(i);var g=n?i.size-s.minSize-i[I]:s.minSize+i[y];Ce.call(i,g)}d.forEach(function(s){var n=s.element[he]()[o];n<s.minSize&&(_t?Ae(s):s.minSize=n)});function Wt(s){var n=Re(s);n.forEach(function(i,g){if(g>0){var f=L[g-1],u=d[f.a],S=d[f.b];u.size=n[g-1],S.size=i,D(u.element,u.size,f[y],u.i),D(S.element,S.size,f[I],S.i)}})}function Vt(s,n){L.forEach(function(i){if(n!==!0?i.parent.removeChild(i.gutter):(i.gutter[w]("mousedown",i[b]),i.gutter[w]("touchstart",i[b])),s!==!0){var g=Ie(o,i.a.size,i[y]);Object.keys(g).forEach(function(f){d[i.a].element.style[f]="",d[i.b].element.style[f]=""})}})}return{setSizes:Wt,getSizes:W,collapse:function(n){Ae(d[n])},destroy:Vt,parent:A,pairs:L}},pt=Jt;var jt=`
<div class="circle-loader">
  <svg class="circular" viewBox="25 25 50 50">
  <circle
    class="path"
    cx="50"
    cy="50"
    r="20"
    fill="none"
    stroke-width="2"
    stroke-miterlimit="10"
  />
  </svg>
</div>
`;function vt(){let t=document.createElement("div");t.className="strigo-loader",t.innerHTML=jt,document.body.appendChild(t)}function Et(){let t=document.querySelector(".strigo-loader");return new Promise(e=>{let r=setInterval(()=>{t.style.opacity||(t.style.opacity="1");let o=parseFloat(t.style.opacity);o>0?t.style.opacity=(o-.1).toString():(t.style.pointerEvents="none",clearInterval(r),e())},200)})}function ye(){let t=ve();if(t){l.info("Posting event",t),window.frames[0].postMessage(t,"*");let e=tt();t.eventName!==e.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:t,poppedEvent:e})}}function ht(){for(;ve();)ye()}function Xt(){document.getElementById("strigo-widget").classList.add("slide-in"),document.getElementById("strigo-widget").classList.add("loaded")}var yt=class{init(){return l.info("overlay init called"),"OVERLAY"}setup({development:e,version:r}){l.info("overlay setup called"),Y({parentElement:B(),url:ke(e,r)});let o=ct(H(p()));this.initEventListeners(o)}shutdown(){l.info("overlay shutdown called"),dt(),Ze()}open(){ut()}initEventListeners(e){Z(e,Xt),X(),window.addEventListener("overlay-widget-event",r=>{q(r?.detail)})}},j=new yt;function q({key:t,oldValue:e,newValue:r}){if(t!=="strigoEvents")return;let o=JSON.parse(r)?.events,a=JSON.parse(e)?.events;o.filter(({eventName:E})=>!a.some(({eventName:O})=>E===O)).length>0&&ye()}function X(){window.addEventListener("message",t=>{if(!(!t||!t.data))switch(t.data){case"close":{window.Strigo?.shutdown();break}case"challenge-success":{l.info("Challenge event success received"),R()==="overlay"&&j.open();break}default:break}},!1)}function Z(t,e){t.addEventListener("load",async()=>{qe("isLoading")&&(e&&await e(),Se("isLoading",!1)),ht()})}function Ot(t){let e=Ye("initSite")?.host;t.addEventListener("load",function(){try{this.contentWindow.location.host!==e&&window.Strigo.shutdown()}catch(r){l.error(r),window.Strigo.shutdown()}})}var It=class{init(){let e;return Fe()?(l.info("Child SDK window"),e="CHILD",window.dispatchEvent(new Event("strigo-opened"))):(l.info("Parent SDK window"),e="PARENT"),e}setup({development:e,version:r}){l.info("iframe setup started"),nt(),Y({parentElement:B(),url:Ve(e,r)}),vt();let o=p(),a=ot(),c=Ee({parentElement:a,url:H(o),classNames:Ne,id:"strigo-exercises"}),E=Ee({parentElement:a,url:Pe(o.initSite.href),classNames:Ge,id:"original-site"});pt(["#strigo-exercises","#original-site"],{sizes:[25,75],maxSize:at(),minSize:gt(),gutterSize:2}),this.initEventListeners(c,E)}shutdown(){l.info("iframe shutdown called"),it()}initEventListeners(e,r){Z(e,Et),Ot(r),X(),window.addEventListener("storage",q)}},Lt=new It;function Ct(t){return t&&t==="dynamic"?lt()?"iframe":"overlay":t}function Q(t){let e=null;switch(t){case"iframe":{e=Lt;break}case"overlay":{e=j;break}default:throw l.error("Widget flavor is not supported",{widgetFlavor:t}),new Error(`Widget flavor ${t} is not supported`)}return e}var xt=class{constructor(){this.initialized=!1;this.configured=!1;this.isOpen=!1;this.sdkType=void 0}init(){try{if(l.info("Initializing SDK..."),this.initialized){l.info("SDK was already initialized");return}Qe();let{webApiKey:e,subDomain:r,selectedWidgetFlavor:o}=We();if(!e||!r||!o)throw new Error("Init data is missing");let a=Ct(o);Ue({webApiKey:e,subDomain:r,selectedWidgetFlavor:a});let c=Q(a);this.sdkType=c.init(),this.initialized=!0,l.info("Initialized SDK."),this.sdkType!=="CHILD"&&je()&&this.setup()}catch(e){l.error("Could not initialize SDK",{err:e})}}async setup(e){try{if(l.info("Starting to setup SDK..."),this.isOpen||this.sdkType==="CHILD"){l.info("panel is already opened");return}let r=p();if(!r)throw new Error("SDK was not initialized");let{email:o,token:a,development:c=!1,version:E,openWidget:O=!0}={...r.user,...r,...e};if(!c&&(!o||!a))throw new Error("Setup data is missing");let d=await $e(a,c);if(d){let{loggingConfig:ee}=d;l.debug("Configuration fetched from Strigo"),l.setup(ee)}Be({user:{email:o,token:a},initSite:be(),development:c,version:E,loggingConfig:d?.loggingConfig}),this.configured=!0,l.info("Finished SDK setup."),O&&this.open()}catch(r){l.error("Could not setup SDK",{err:r})}}open(){try{if(!this.configured)throw new Error("SDK was not set up");if(this.isOpen||this.sdkType==="CHILD"){l.info("Panel is already opened");return}let e=p();Je({currentUrl:e.initSite.href,isPanelOpen:!0,isLoading:!0,widgetFlavor:e.selectedWidgetFlavor}),Q(e.selectedWidgetFlavor).setup({version:e.version,development:e.development}),this.isOpen=!0}catch(e){l.error("Could not open Strigo widget",{err:e})}}shutdown(){try{if(l.info("Shutting down SDK..."),this.sdkType==="CHILD"){window.parent.postMessage("close","*");return}let e=Q(R());Xe(),e.shutdown(),this.isOpen=!1,l.info("Finished SDK shutdown.")}catch(e){l.error("Could not shutdown SDK",{err:e})}}sendEvent(e){et({eventName:e}),l.debug("sendEvent called",{eventName:e})}},Rt=new xt;window.Strigo=Rt;window.Strigo.init();})();
