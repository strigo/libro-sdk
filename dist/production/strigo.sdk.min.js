(()=>{var tt=Object.defineProperty;var rt=(t,r)=>{for(var i in r)tt(t,i,{get:r[i],enumerable:!0})};var v=typeof window!="undefined"?window:null,Q=v===null,D=Q?void 0:v.document,E="addEventListener",O="removeEventListener",X="getBoundingClientRect",b="_a",h="_b",y="_c",H="horizontal",T=function(){return!1},nt=Q?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var r=D.createElement("div");return r.style.cssText="width:"+t+"calc(9px)",!!r.style.length}).shift()+"calc",de=function(t){return typeof t=="string"||t instanceof String},pe=function(t){if(de(t)){var r=D.querySelector(t);if(!r)throw new Error("Selector "+t+" did not match a DOM element");return r}return t},g=function(t,r,i){var a=t[r];return a!==void 0?a:i},J=function(t,r,i,a){if(r){if(a==="end")return 0;if(a==="center")return t/2}else if(i){if(a==="start")return 0;if(a==="center")return t/2}return t},ot=function(t,r){var i=D.createElement("div");return i.className="gutter gutter-"+r,i},it=function(t,r,i){var a={};return de(r)?a[t]=r:a[t]=nt+"("+r+"% - "+i+"px)",a},st=function(t,r){var i;return i={},i[t]=r+"px",i},at=function(t,r){if(r===void 0&&(r={}),Q)return{};var i=t,a,c,d,U,B,l;Array.from&&(i=Array.from(i));var f=pe(i[0]),m=f.parentNode,R=getComputedStyle?getComputedStyle(m):null,C=R?R.flexDirection:null,I=g(r,"sizes")||i.map(function(){return 100/i.length}),x=g(r,"minSize",100),w=Array.isArray(x)?x:i.map(function(){return x}),N=g(r,"maxSize",1/0),Ke=Array.isArray(N)?N:i.map(function(){return N}),He=g(r,"expandToMin",!1),L=g(r,"gutterSize",10),F=g(r,"gutterAlign","center"),Y=g(r,"snapOffset",30),Je=Array.isArray(Y)?Y:i.map(function(){return Y}),Z=g(r,"dragInterval",1),z=g(r,"direction",H),q=g(r,"cursor",z===H?"col-resize":"row-resize"),je=g(r,"gutter",ot),Se=g(r,"elementStyle",it),$e=g(r,"gutterStyle",st);z===H?(a="width",c="clientX",d="left",U="right",B="clientWidth"):z==="vertical"&&(a="height",c="clientY",d="top",U="bottom",B="clientHeight");function M(o,e,n,s){var u=Se(a,e,n,s);Object.keys(u).forEach(function(S){o.style[S]=u[S]})}function We(o,e,n){var s=$e(a,e,n);Object.keys(s).forEach(function(u){o.style[u]=s[u]})}function k(){return l.map(function(o){return o.size})}function ce(o){return"touches"in o?o.touches[0][c]:o[c]}function ue(o){var e=l[this.a],n=l[this.b],s=e.size+n.size;e.size=o/this.size*s,n.size=s-o/this.size*s,M(e.element,e.size,this[h],e.i),M(n.element,n.size,this[y],n.i)}function Ye(o){var e,n=l[this.a],s=l[this.b];!this.dragging||(e=ce(o)-this.start+(this[h]-this.dragOffset),Z>1&&(e=Math.round(e/Z)*Z),e<=n.minSize+n.snapOffset+this[h]?e=n.minSize+this[h]:e>=this.size-(s.minSize+s.snapOffset+this[y])&&(e=this.size-(s.minSize+this[y])),e>=n.maxSize-n.snapOffset+this[h]?e=n.maxSize+this[h]:e<=this.size-(s.maxSize-s.snapOffset+this[y])&&(e=this.size-(s.maxSize+this[y])),ue.call(this,e),g(r,"onDrag",T)(k()))}function ge(){var o=l[this.a].element,e=l[this.b].element,n=o[X](),s=e[X]();this.size=n[a]+s[a]+this[h]+this[y],this.start=n[d],this.end=n[U]}function Ze(o){if(!getComputedStyle)return null;var e=getComputedStyle(o);if(!e)return null;var n=o[B];return n===0?null:(z===H?n-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight):n-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),n)}function fe(o){var e=Ze(m);if(e===null||w.reduce(function(S,p){return S+p},0)>e)return o;var n=0,s=[],u=o.map(function(S,p){var _=e*S/100,V=J(L,p===0,p===o.length-1,F),K=w[p]+V;return _<K?(n+=K-_,s.push(0),K):(s.push(_-K),_)});return n===0?o:u.map(function(S,p){var _=S;if(n>0&&s[p]-n>0){var V=Math.min(n,s[p]-n);n-=V,_=S-V}return _/e*100})}function qe(){var o=this,e=l[o.a].element,n=l[o.b].element;o.dragging&&g(r,"onDragEnd",T)(k()),o.dragging=!1,v[O]("mouseup",o.stop),v[O]("touchend",o.stop),v[O]("touchcancel",o.stop),v[O]("mousemove",o.move),v[O]("touchmove",o.move),o.stop=null,o.move=null,e[O]("selectstart",T),e[O]("dragstart",T),n[O]("selectstart",T),n[O]("dragstart",T),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",o.gutter.style.cursor="",o.parent.style.cursor="",D.body.style.cursor=""}function Xe(o){if(!("button"in o&&o.button!==0)){var e=this,n=l[e.a].element,s=l[e.b].element;e.dragging||g(r,"onDragStart",T)(k()),o.preventDefault(),e.dragging=!0,e.move=Ye.bind(e),e.stop=qe.bind(e),v[E]("mouseup",e.stop),v[E]("touchend",e.stop),v[E]("touchcancel",e.stop),v[E]("mousemove",e.move),v[E]("touchmove",e.move),n[E]("selectstart",T),n[E]("dragstart",T),s[E]("selectstart",T),s[E]("dragstart",T),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",e.gutter.style.cursor=q,e.parent.style.cursor=q,D.body.style.cursor=q,ge.call(e),e.dragOffset=ce(o)-e.end}}I=fe(I);var A=[];l=i.map(function(o,e){var n={element:pe(o),size:I[e],minSize:w[e],maxSize:Ke[e],snapOffset:Je[e],i:e},s;if(e>0&&(s={a:e-1,b:e,dragging:!1,direction:z,parent:m},s[h]=J(L,e-1===0,!1,F),s[y]=J(L,!1,e===i.length-1,F),C==="row-reverse"||C==="column-reverse")){var u=s.a;s.a=s.b,s.b=u}if(e>0){var S=je(e,z,n.element);We(S,L,e),s[b]=Xe.bind(s),S[E]("mousedown",s[b]),S[E]("touchstart",s[b]),m.insertBefore(S,n.element),s.gutter=S}return M(n.element,n.size,J(L,e===0,e===i.length-1,F),e),e>0&&A.push(s),n});function me(o){var e=o.i===A.length,n=e?A[o.i-1]:A[o.i];ge.call(n);var s=e?n.size-o.minSize-n[y]:o.minSize+n[h];ue.call(n,s)}l.forEach(function(o){var e=o.element[X]()[a];e<o.minSize&&(He?me(o):o.minSize=e)});function Qe(o){var e=fe(o);e.forEach(function(n,s){if(s>0){var u=A[s-1],S=l[u.a],p=l[u.b];S.size=e[s-1],p.size=n,M(S.element,S.size,u[h],S.i),M(p.element,p.size,u[y],p.i)}})}function et(o,e){A.forEach(function(n){if(e!==!0?n.parent.removeChild(n.gutter):(n.gutter[O]("mousedown",n[b]),n.gutter[O]("touchstart",n[b])),o!==!0){var s=Se(a,n.a.size,n[h]);Object.keys(s).forEach(function(u){l[n.a].element.style[u]="",l[n.b].element.style[u]=""})}})}return{setSizes:Qe,getSizes:k,collapse:function(e){me(l[e])},destroy:et,parent:m,pairs:A}},ve=at;function Ee(){return document.getElementsByTagName("head")[0]}function Oe(){document.open(),document.close()}function he(){let t=document.createElement("div");return t.className="strigo-main",document.body.appendChild(t),t}function Te(t){let{url:r,parentElement:i}=t,a=document.createElement("link");a.rel="stylesheet",a.href=r,i.appendChild(a)}function ee(t){let{url:r,parentElement:i,classNames:a,id:c}=t,d=document.createElement("iframe");d.classList.add(...a),d.id=c,d.src=r,i.appendChild(d)}function ye(){location.reload()}function Ie(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}var xe="strigo.io",we="localhost:3000",Re="https://cdn.jsdelivr.net/gh/strigo/strigo-sdk@latest/dist/production/styles/strigo.min.css",Ce=["strigo-exercises"],Ae=["orig-iframe"],_e=0,Ge=450;function St(t){let r={};for(let[i,a]of t)r[i]=a;return r}function ze(){let{host:t,pathname:r,href:i,origin:a,search:c}=window.location;return{host:t,pathName:r,href:i,origin:a,search:c,params:ct(c)}}function ct(t){let i=new URLSearchParams(t).entries();return St(i)}function Ne(t){let{subDomain:r,token:i,webApiKey:a,development:c}=t;return c?`http://${we}/libro/courses?token=${i.token}&webApiKey=${a}`:`https://${r}.${xe}/libro/courses?token=${i.token}&webApiKey=${a}`}function G(t,r){try{return JSON.parse(window[t].getItem(r))}catch(i){return console.log(i),null}}function j(t,r,i){try{return window[t].setItem(r,JSON.stringify(i)),i}catch(a){return console.log(a),null}}function te(t,r,i,a){try{let c=G(t,r);if(!c)throw new Error("Can't find initial state");let d={...c,[i]:a};return window[t].setItem(r,JSON.stringify(d)),d}catch(c){return console.log(c),null}}function P(t,r){try{window[t].removeItem(r)}catch(i){console.log(i)}}function be(){return G("localStorage","strigoConfig")}function De(t){return j("localStorage","strigoConfig",t)}function $(){return G("localStorage","strigoConfig")}function Pe(){P("localStorage","strigoConfig")}var se={};rt(se,{clearSession:()=>ie,getSession:()=>Ue,init:()=>re,isPanelOpen:()=>oe,setSessionValue:()=>ft,setup:()=>ne});function re(){let t=G("sessionStorage","strigoSession");return t}function ne(t){return j("sessionStorage","strigoSession",t)}function oe(){return Ue()?.isPanelOpen}function Ue(){return G("sessionStorage","strigoSession")}function ft(t,r){return te("sessionStorage","strigoSession",t,r)}function ie(){P("sessionStorage","strigoSession")}window.onunload=function(){P("sessionStorage","strigoSession")};function Be(){try{let t=W();if(t)return console.log("Events storage already exists"),t;let r={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(r)),r}catch(t){return console.log("Init events storage error",{error:t}),null}}function W(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(t){return console.log("Get events storage error",{error:t}),null}}function Fe(t){try{let r=W();if(!r)throw new Error("Can't find initial state");return r.events.push(t),window["localStorage"].setItem("strigoEvents",JSON.stringify(r)),r}catch(r){return console.log("Push event to storage error",{error:r}),null}}function ke(){try{let t=W();if(!t)throw new Error("Can't find events storage");let r=t.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),r}catch(t){return console.log("Pop event from storage error",{error:t}),null}}function ae(){try{let t=W();if(!t)throw new Error("Can't find events storage");return t.events.pop()}catch(t){return console.log("Get event from storage error",{error:t}),null}}function Ve(){window.addEventListener("message",t=>{if(!(!t||!t.data))switch(t.data){case"close":{window.StrigoSDK&&window.StrigoSDK.shutdown();break}default:break}},!1)}var le;(l=>{function r(){let f=ae();if(f){console.log("Posting event",f),window.frames[0].postMessage(f,"*");let m=ke();f.eventName!==m.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:f,poppedEvent:m})}}function i(){for(;ae();)r()}function a({key:f,oldValue:m,newValue:R}){let C=JSON.parse(R)?.events,I=JSON.parse(m)?.events;C.filter(({eventName:w})=>!I.some(({eventName:N})=>w===N)).length>0&&r()}function c(){be(),re(),Be(),se&&oe()?l.SDKType="SUBSCRIBER":l.SDKType="HOST",console.log("init called")}l.init=c;function d(f){if(l.SDKType==="SUBSCRIBER")return;console.log("setup started");let{email:m,token:R,webApiKey:C,subDomain:I,development:x=!1}=f;if(!x&&(!m||!R||!C||!I)){console.log("Please provide setup data");return}De({email:m,initSite:ze(),token:R,webApiKey:C,subDomain:I,development:x}),Oe(),Te({parentElement:Ee(),url:x?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:Re});let w=he();ee({parentElement:w,url:Ne($()),classNames:Ce,id:"exercises"}),ee({parentElement:w,url:$().initSite.href,classNames:Ae,id:"original-site"}),ve(["#exercises","#original-site"],{sizes:[25,75],minSize:Ie()?_e:Ge}),ne({currentUrl:$().initSite.href,isPanelOpen:!0}),i(),window.addEventListener("storage",a),Ve(),console.log("setup finished")}l.setup=d;function U(){console.log("shutdown called"),Pe(),ie(),ye()}l.shutdown=U;function B(f){Fe({eventName:f}),console.log("sendEvent called",{eventName:f})}l.sendEvent=B})(le||={});window.StrigoSDK=le;window.StrigoSDK.init();})();
