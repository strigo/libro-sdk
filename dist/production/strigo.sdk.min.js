(()=>{var Be="strigo-sdk",Ye="strigo.io",$e="localhost:3000",Je=["strigo-exercises"],qe=["orig-iframe"],be=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"/></svg>
`,je=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M224 480c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25l192-192c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l169.4 169.4c12.5 12.5 12.5 32.75 0 45.25C240.4 476.9 232.2 480 224 480z"/></svg>
`,re="https://cdn.jsdelivr.net/gh/strigo/strigo-sdk";var _e="strigoChildIframe";function er(t){let e={};for(let[r,o]of t)e[r]=o;return e}function tr(t){let r=new URLSearchParams(t).entries();return er(r)}function Xe(){let{host:t,pathname:e,href:r,origin:o,search:s}=window.location;return{host:t,pathName:e,href:r,origin:o,search:s,params:tr(s)}}function ue(t){let{subDomain:e,user:r,webApiKey:o,development:s}=t;return s?`http://${$e}/academy/courses?token=${r.token.token}&webApiKey=${o}`:`https://${e}.${Ye}/academy/courses?token=${r.token.token}&webApiKey=${o}`}function Ze(t){let e=new URL(t);return e.searchParams.set(_e,"true"),e.toString()}function Qe(){return window.location.search.includes(_e)}function et(){let t=new URL(window.location.href),e=new URLSearchParams(t.search);e.delete(_e),t.search=e.toString(),window.history.replaceState(window.history.state,"",t)}function tt(){let t=document.getElementById(Be);return{webApiKey:t?.getAttribute("data-web-api-key")||"",subDomain:t?.getAttribute("data-subdomain")||"",selectedWidgetFlavor:t?.getAttribute("data-layout-flavor")||"dynamic"}}function rt(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:e?`${re}@${e}/dist/production/styles/strigo.min.css`:`${re}@master/dist/production/styles/strigo.min.css`}function nt(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo-widget.css`:e?`${re}@${e}/dist/production/styles/strigo-widget.min.css`:`${re}@master/dist/production/styles/strigo-widget.min.css`}var ot=class{constructor(e){this.url=e?.url}setup(e){this.url=e.url}logToRemote(e,r,o){return fetch(this.url,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({level:e,message:r,context:o})}).then(s=>{s.ok||console.warn("Logging to Strigo failed",{result:s})}).catch(s=>{console.warn("Logging to Strigo failed",{err:s})})}logToConsole(e,r,o){let s=`${new Date().toISOString()} - ${r}`,f=o.err instanceof Error?{...o,err:{message:o.err.message,name:o.err.name,stack:o.err.stack}}:o;console[e](s,o?`
${JSON.stringify(f)}`:"")}getDefaultContext(){let e=b();if(!e)return{};let{user:r,subDomain:o,initSite:s,development:f,version:E,selectedWidgetFlavor:T}=e;return{token:r?.token.token,initSite:s?.href,subDomain:o,development:f,version:E,selectedWidgetFlavor:T}}log(e,r,o){let s={...this.getDefaultContext(),...o};try{this.url&&!b()?.development&&this.logToRemote(e,r,s),this.logToConsole(e,`Academy - ${r}`,s)}catch(f){console.log("Logging error:",{err:f})}}debug(e,r={}){this.log("debug",e,r)}info(e,r={}){this.log("info",e,r)}warn(e,r={}){this.log("warn",e,r)}error(e,r={}){this.log("error",e,r)}},g=new ot;function oe(t,e){try{return JSON.parse(window[t].getItem(e))}catch(r){return g.error("get storage data error",{err:r}),null}}function ie(t,e,r){try{return window[t].setItem(e,JSON.stringify(r)),r}catch(o){return g.error("setup storage error",{err:o}),null}}function De(t,e,r,o){try{let s=oe(t,e);if(!s)throw new Error("Can't find initial state");let f={...s,[r]:o};return window[t].setItem(e,JSON.stringify(f)),f}catch(s){return g.error("set storage value error",{err:s}),null}}function fe(t,e){try{window[t].removeItem(e)}catch(r){g.error("clear storage error",{err:r})}}function b(){return oe("localStorage","strigoConfig")}function it(t){let e=b();return ie("localStorage","strigoConfig",{...e,...t})}function st(t){let e=b();return ie("localStorage","strigoConfig",{...e,...t})}function at(t){return b()?.[t]}function lt(){fe("localStorage","strigoConfig")}async function ct(t,e){try{let o=await fetch(`${e?"http://localhost:3000":"https://app.strigo.io"}/api/internal/academy/v1/config`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`}});if(!o.ok)throw new Error(`Failed to fetch remote configuration: ${o.statusText}`);return(await o.json()).data}catch(r){return g.warn("Error fetching configuration from Strigo",{err:r}),null}}function gt(t){return ie("sessionStorage","strigoSession",t)}function Ge(){return oe("sessionStorage","strigoSession")}function dt(){return Ge()?.isPanelOpen}function Z(){return Ge()?.widgetFlavor}function ut(t,e){return De("sessionStorage","strigoSession",t,e)}function ft(t){return Ge()?.[t]}function mt(){fe("sessionStorage","strigoSession")}function Se(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(t){return g.error("Get events storage error",{error:t}),null}}function St(){try{let t=Se();if(t)return g.debug("Events storage already exists"),t;let e={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),e}catch(t){return g.error("Init events storage error",{error:t}),null}}function pt(t){try{let e=Se();if(!e)throw new Error("Can't find initial state");let r=JSON.stringify(e);if(e.events.push(t),window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),Z()==="overlay"){let o=new CustomEvent("overlay-widget-event",{bubbles:!0,detail:{key:"strigoEvents",oldValue:r,newValue:JSON.stringify(e)}});window.dispatchEvent(o)}return e}catch(e){return g.error("Push event to storage error",{error:e}),null}}function vt(){try{let t=Se();if(!t)throw new Error("Can't find events storage");let e=t.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),e}catch(t){return g.error("Pop event from storage error",{error:t}),null}}function We(){try{let t=Se();if(!t)throw new Error("Can't find events storage");return t.events.pop()}catch(t){return g.error("Get event from storage error",{error:t}),null}}function ht(){try{window["localStorage"].removeItem("strigoEvents")}catch(t){g.error("Clear events storage error",{error:t})}}function ke(){try{return JSON.parse(window["localStorage"].getItem("strigoAssessments"))}catch(t){return g.error("Get assessments storage error",{error:t}),null}}function yt(){try{let t=ke();if(t)return g.debug("Assessments storage already exists"),t;let e={assessments:[]};return window["localStorage"].setItem("strigoAssessments",JSON.stringify(e)),e}catch(t){return g.error("Init assessments storage error",{error:t}),null}}function wt(t){try{let e=t?{assessments:[...t]}:{assessments:[]};return window["localStorage"].setItem("strigoAssessments",JSON.stringify(e)),e}catch(e){return g.error("Assessments storage setup error",{error:e}),null}}function Ot(){try{window["localStorage"].removeItem("strigoAssessments")}catch(t){g.error("Clear assessments storage error",{error:t})}}function pe(){return document.getElementsByTagName("head")[0]}function Tt(){document.open(),document.close()}function It(){let t=document.createElement("div");return t.className="strigo-main",document.body.appendChild(t),t}function ve(t){let{url:e,parentElement:r}=t,o=document.createElement("link");o.rel="stylesheet",o.href=e,r.appendChild(o)}function He(t){let{url:e,parentElement:r,classNames:o,id:s}=t,f=document.createElement("iframe");return f.classList.add(...o),f.id=s,f.src=e,r.appendChild(f),f}function Ct(){location.reload()}function Lt(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function At(){return Lt()?[window.screen.width,window.screen.width]:[window.screen.width/2,window.screen.width]}function xt(){return Lt()?[0,0]:[window.screen.width*.25,0]}function Rt(){let t=new XMLHttpRequest;t.open("GET",window.document.location.href,!1),t.send(null);let r=t.getAllResponseHeaders().toLowerCase().split(`\r
`);for(let o of r)if(o.includes("x-frame-options")){let s=o.split(":");if(s&&s.length>1)return s[1].trim()!=="deny"}return!0}function nr(){let t=document.getElementById("strigo-widget"),e=t.classList.contains("slide-in");t.classList.toggle("slide-in"),setTimeout(()=>{let r=document.getElementById("strigo-arrow");r.innerHTML=e?je:be},300)}function bt(t){let e=document.createElement("div");e.className="strigo-arrow",e.id="strigo-arrow",e.innerHTML=be;let r=document.createElement("div");r.className="strigo-collapse-button",r.id="strigo-toggle",r.appendChild(e);let o=document.createElement("div");o.className="strigo-collapse-div",o.onclick=()=>{nr()},o.appendChild(r);let s=document.createElement("iframe");s.className="strigo-iframe",s.id="strigo-exercises",s.src=t;let f=document.createElement("div");return f.id="strigo-widget",f.appendChild(o),f.appendChild(s),document.body.appendChild(f),s}function Nt(){document.getElementById("strigo-widget").remove()}function _t(){let t=document.getElementById("strigo-widget");t.classList.contains("slide-in")||t.classList.add("slide-in")}var N=typeof window!="undefined"?window:null,Ue=N===null,ae=Ue?void 0:N.document,P="addEventListener",G="removeEventListener",Ve="getBoundingClientRect",se="_a",z="_b",k="_c",he="horizontal",F=function(){return!1},or=Ue?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var e=ae.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length}).shift()+"calc",Pt=function(t){return typeof t=="string"||t instanceof String},Dt=function(t){if(Pt(t)){var e=ae.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},A=function(t,e,r){var o=t[e];return o!==void 0?o:r},Ee=function(t,e,r,o){if(e){if(o==="end")return 0;if(o==="center")return t/2}else if(r){if(o==="start")return 0;if(o==="center")return t/2}return t},ir=function(t,e){var r=ae.createElement("div");return r.className="gutter gutter-"+e,r},sr=function(t,e,r){var o={};return Pt(e)?o[t]=e:o[t]=or+"("+e+"% - "+r+"px)",o},ar=function(t,e){var r;return r={},r[t]=e+"px",r},lr=function(t,e){if(e===void 0&&(e={}),Ue)return{};var r=t,o,s,f,E,T,p;Array.from&&(r=Array.from(r));var w=Dt(r[0]),_=w.parentNode,M=getComputedStyle?getComputedStyle(_):null,V=M?M.flexDirection:null,J=A(e,"sizes")||r.map(function(){return 100/r.length}),Q=A(e,"minSize",100),ee=Array.isArray(Q)?Q:r.map(function(){return Q}),te=A(e,"maxSize",1/0),Le=Array.isArray(te)?te:r.map(function(){return te}),Ae=A(e,"expandToMin",!1),U=A(e,"gutterSize",10),H=A(e,"gutterAlign","center"),K=A(e,"snapOffset",30),D=Array.isArray(K)?K:r.map(function(){return K}),q=A(e,"dragInterval",1),W=A(e,"direction",he),j=A(e,"cursor",W===he?"col-resize":"row-resize"),le=A(e,"gutter",ir),ce=A(e,"elementStyle",sr),xe=A(e,"gutterStyle",ar);W===he?(o="width",s="clientX",f="left",E="right",T="clientWidth"):W==="vertical"&&(o="height",s="clientY",f="top",E="bottom",T="clientHeight");function B(a,n,l,u){var C=ce(o,n,l,u);Object.keys(C).forEach(function(O){a.style[O]=C[O]})}function Re(a,n,l){var u=xe(o,n,l);Object.keys(u).forEach(function(C){a.style[C]=u[C]})}function X(){return p.map(function(a){return a.size})}function Y(a){return"touches"in a?a.touches[0][s]:a[s]}function i(a){var n=p[this.a],l=p[this.b],u=n.size+l.size;n.size=a/this.size*u,l.size=u-a/this.size*u,B(n.element,n.size,this[z],n.i),B(l.element,l.size,this[k],l.i)}function d(a){var n,l=p[this.a],u=p[this.b];!this.dragging||(n=Y(a)-this.start+(this[z]-this.dragOffset),q>1&&(n=Math.round(n/q)*q),n<=l.minSize+l.snapOffset+this[z]?n=l.minSize+this[z]:n>=this.size-(u.minSize+u.snapOffset+this[k])&&(n=this.size-(u.minSize+this[k])),n>=l.maxSize-l.snapOffset+this[z]?n=l.maxSize+this[z]:n<=this.size-(u.maxSize-u.snapOffset+this[k])&&(n=this.size-(u.maxSize+this[k])),i.call(this,n),A(e,"onDrag",F)(X()))}function c(){var a=p[this.a].element,n=p[this.b].element,l=a[Ve](),u=n[Ve]();this.size=l[o]+u[o]+this[z]+this[k],this.start=l[f],this.end=l[E]}function m(a){if(!getComputedStyle)return null;var n=getComputedStyle(a);if(!n)return null;var l=a[T];return l===0?null:(W===he?l-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight):l-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),l)}function S(a){var n=m(_);if(n===null||ee.reduce(function(O,R){return O+R},0)>n)return a;var l=0,u=[],C=a.map(function(O,R){var $=n*O/100,ge=Ee(U,R===0,R===a.length-1,H),de=ee[R]+ge;return $<de?(l+=de-$,u.push(0),de):(u.push($-de),$)});return l===0?a:C.map(function(O,R){var $=O;if(l>0&&u[R]-l>0){var ge=Math.min(l,u[R]-l);l-=ge,$=O-ge}return $/n*100})}function I(){var a=this,n=p[a.a].element,l=p[a.b].element;a.dragging&&A(e,"onDragEnd",F)(X()),a.dragging=!1,N[G]("mouseup",a.stop),N[G]("touchend",a.stop),N[G]("touchcancel",a.stop),N[G]("mousemove",a.move),N[G]("touchmove",a.move),a.stop=null,a.move=null,n[G]("selectstart",F),n[G]("dragstart",F),l[G]("selectstart",F),l[G]("dragstart",F),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",l.style.userSelect="",l.style.webkitUserSelect="",l.style.MozUserSelect="",l.style.pointerEvents="",a.gutter.style.cursor="",a.parent.style.cursor="",ae.body.style.cursor=""}function v(a){if(!("button"in a&&a.button!==0)){var n=this,l=p[n.a].element,u=p[n.b].element;n.dragging||A(e,"onDragStart",F)(X()),a.preventDefault(),n.dragging=!0,n.move=d.bind(n),n.stop=I.bind(n),N[P]("mouseup",n.stop),N[P]("touchend",n.stop),N[P]("touchcancel",n.stop),N[P]("mousemove",n.move),N[P]("touchmove",n.move),l[P]("selectstart",F),l[P]("dragstart",F),u[P]("selectstart",F),u[P]("dragstart",F),l.style.userSelect="none",l.style.webkitUserSelect="none",l.style.MozUserSelect="none",l.style.pointerEvents="none",u.style.userSelect="none",u.style.webkitUserSelect="none",u.style.MozUserSelect="none",u.style.pointerEvents="none",n.gutter.style.cursor=j,n.parent.style.cursor=j,ae.body.style.cursor=j,c.call(n),n.dragOffset=Y(a)-n.end}}J=S(J);var h=[];p=r.map(function(a,n){var l={element:Dt(a),size:J[n],minSize:ee[n],maxSize:Le[n],snapOffset:D[n],i:n},u;if(n>0&&(u={a:n-1,b:n,dragging:!1,direction:W,parent:_},u[z]=Ee(U,n-1===0,!1,H),u[k]=Ee(U,!1,n===r.length-1,H),V==="row-reverse"||V==="column-reverse")){var C=u.a;u.a=u.b,u.b=C}if(n>0){var O=le(n,W,l.element);Re(O,U,n),u[se]=v.bind(u),O[P]("mousedown",u[se]),O[P]("touchstart",u[se]),_.insertBefore(O,l.element),u.gutter=O}return B(l.element,l.size,Ee(U,n===0,n===r.length-1,H),n),n>0&&h.push(u),l});function y(a){var n=a.i===h.length,l=n?h[a.i-1]:h[a.i];c.call(l);var u=n?l.size-a.minSize-l[k]:a.minSize+l[z];i.call(l,u)}p.forEach(function(a){var n=a.element[Ve]()[o];n<a.minSize&&(Ae?y(a):a.minSize=n)});function L(a){var n=S(a);n.forEach(function(l,u){if(u>0){var C=h[u-1],O=p[C.a],R=p[C.b];O.size=n[u-1],R.size=l,B(O.element,O.size,C[z],O.i),B(R.element,R.size,C[k],R.i)}})}function x(a,n){h.forEach(function(l){if(n!==!0?l.parent.removeChild(l.gutter):(l.gutter[G]("mousedown",l[se]),l.gutter[G]("touchstart",l[se])),a!==!0){var u=ce(o,l.a.size,l[z]);Object.keys(u).forEach(function(C){p[l.a].element.style[C]="",p[l.b].element.style[C]=""})}})}return{setSizes:L,getSizes:X,collapse:function(n){y(p[n])},destroy:x,parent:_,pairs:h}},Gt=lr;var cr=`
<div class="circle-loader">
  <svg class="circular" viewBox="25 25 50 50">
  <circle
    class="path"
    cx="50"
    cy="50"
    r="20"
    fill="none"
    stroke-width="2"
    stroke-miterlimit="10"
  />
  </svg>
</div>
`;function zt(){let t=document.createElement("div");t.className="strigo-loader",t.innerHTML=cr,document.body.appendChild(t)}function Ft(){let t=document.querySelector(".strigo-loader");return new Promise(e=>{let r=setInterval(()=>{t.style.opacity||(t.style.opacity="1");let o=parseFloat(t.style.opacity);o>0?t.style.opacity=(o-.1).toString():(t.style.pointerEvents="none",clearInterval(r),e())},200)})}function Ke(){let t=We();if(t){g.info("Posting event",t),document.getElementById("strigo-exercises").contentWindow.postMessage(t,"*");let r=vt();t.eventName!==r.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:t,poppedEvent:r})}}function Wt(){for(;We();)Ke()}var ye=function(t){let e=t.document,r=ke().assessments,o=function(){r.forEach(f=>{let{eventName:E,expectedResult:T,selector:p}=f,w=e.querySelector(p);(w?.innerText?.includes(T)||w?.value?.includes(T))&&t.Strigo.sendEvent(E)})},s=new MutationObserver(o);return s.observe(e,{subtree:!0,attributes:!0,attributeOldValue:!0,characterDataOldValue:!0,characterData:!0}),s};function dr(){document.getElementById("strigo-widget").classList.add("slide-in"),document.getElementById("strigo-widget").classList.add("loaded")}var Vt=class{constructor(){this.onStrigoEventHandler=e=>{Oe(e?.detail)}}init(){return g.info("overlay init called"),"OVERLAY"}setup({development:e,version:r}){g.info("overlay setup called"),ve({parentElement:pe(),url:nt(e,r)});let o=bt(ue(b()));this.initEventListeners(o),this.documentObserver=ye(window)}shutdown(){g.info("overlay shutdown called"),this.removeEventListeners(),this.documentObserver.disconnect(),Nt()}open(){_t()}initEventListeners(e){Ie(e,dr),Te(),window.addEventListener("overlay-widget-event",this.onStrigoEventHandler)}removeEventListeners(){Ut(),window.removeEventListener("overlay-widget-event",this.onStrigoEventHandler)}},we=new Vt;function Oe({key:t,oldValue:e,newValue:r}){if(t!=="strigoEvents")return;let o=JSON.parse(r)?.events,s=JSON.parse(e)?.events;o.filter(({eventName:E})=>!s.some(({eventName:T})=>E===T)).length>0&&Ke()}function Bt(t){if(!(!t||!t.data))switch(t.data){case"close":{g.info("Shutdown message received"),window.Strigo?.shutdown();break}case"destroy":{g.info("Destroy message received"),window.Strigo?.destroy();break}case"challenge-success":{g.info("Challenge event success received"),Z()==="overlay"&&we.open();break}default:break}}function Te(){window.addEventListener("message",Bt,!1)}function Ut(){window.removeEventListener("message",Bt)}function Ie(t,e){t.addEventListener("load",async()=>{ft("isLoading")&&(e&&await e(),ut("isLoading",!1)),Wt()})}function Yt(t){let e=at("initSite")?.host;t.addEventListener("load",function(){ye(t.contentWindow);try{this.contentWindow.location.host!==e&&window.Strigo.shutdown()}catch(r){g.error(r),window.Strigo.shutdown()}})}var $t=class{init(){let e;return Qe()?(g.info("Child SDK window"),e="CHILD",window.dispatchEvent(new Event("strigo-opened")),et()):(g.info("Parent SDK window"),e="PARENT"),e}setup({development:e,version:r}){g.info("iframe setup started"),Tt(),ve({parentElement:pe(),url:rt(e,r)}),zt();let o=b(),s=It(),f=He({parentElement:s,url:ue(o),classNames:Je,id:"strigo-exercises"}),E=He({parentElement:s,url:Ze(o.initSite.href),classNames:qe,id:"original-site"});Gt(["#strigo-exercises","#original-site"],{sizes:[25,75],maxSize:At(),minSize:xt(),gutterSize:2}),this.initEventListeners(f,E)}shutdown(){g.info("iframe shutdown called"),Ct()}initEventListeners(e,r){Ie(e,Ft),Yt(r),Te(),window.addEventListener("storage",Oe)}},Jt=new $t;function qt(t){return t&&t==="dynamic"?Rt()?"iframe":"overlay":t}function Ce(t){let e=null;switch(t){case"iframe":{e=Jt;break}case"overlay":{e=we;break}default:throw g.error("Widget flavor is not supported",{widgetFlavor:t}),new Error(`Widget flavor ${t} is not supported`)}return e}function jt(){var t;(function(i){i[i.All=0]="All",i[i.Two=1]="Two",i[i.One=2]="One"})(t||(t={}));let e,r;function o(i,d){if(i.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if(i.tagName.toLowerCase()==="html")return"html";let c={root:document.body,idName:S=>!0,className:S=>!0,tagName:S=>!0,attr:(S,I)=>!1,seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};return e=Object.assign(Object.assign({},c),d),r=T(e.root,c),p(i)}function s(i,d){let c={root:document.body,idName:S=>!0,className:S=>!0,tagName:S=>!0,attr:(S,I)=>!1,seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};e=Object.assign(Object.assign({},c),d),r=T(e.root,c);let m=w(i,t.All,()=>w(i,t.Two,()=>w(i,t.One)));if(m){let S=M(m),I=r.querySelector(S),v=j(le(m,I));return v.length>0&&(m=v[0]),M(m)}else throw new Error("Selector was not found.")}function f(i,d){let c=D(i.find(y=>y.identifier==="id")),m=D(...i.filter(y=>y.identifier==="attribute")),S=D(...i.filter(y=>y.identifier==="className")),I=D(...i.filter(y=>y.identifier==="tagName")),v=i.find(y=>y.identifier==="index").index,h=c||m||S||I||[Ae()];if(d===t.All)v&&(h=h.concat(h.filter(K).map(y=>H(y,v))));else if(d===t.Two)h=h.slice(0,1),v&&(h=h.concat(h.filter(K).map(y=>H(y,v))));else if(d===t.One){let[y]=h=h.slice(0,1);v&&K(y)&&(h=[H(y,v)])}return h}function E(i,d){return i.map(({nodeIdentifiers:m,level:S})=>{let I=f(m,d);for(let v of I)v.level=S;return I})}function T(i,d){return i.nodeType===Node.DOCUMENT_NODE?i:i===d.root?i.ownerDocument:i}function p(i){let d=[],c=i,m=0;for(;c&&c!==e.root.parentElement;){let S=[D(Q(c)),D(Le(c)),D(...ee(c)),D(...te(c)),D(U(c))].filter(q).flat().sort((I,v)=>I.penalty-v.penalty);if(d.push({nodeIdentifiers:S,level:m}),d.length>=e.seedMinLength&&w(d,t.All,()=>w(d,t.Two,()=>w(d,t.One))))break;c=c.parentElement,m++}return d}function w(i,d,c){let m=E(i,d);return _(m,c)}function _(i,d){let c=j(W(i));if(c.length>e.threshold)return d?d():null;for(let m of c)if(J(m))return m;return null}function M(i){let d=i[0],c=d.name;for(let m=1;m<i.length;m++){let S=i[m].level||0;d.level===S-1?c=`${i[m].name} > ${c}`:c=`${i[m].name} ${c}`,d=i[m]}return c}function V(i){return i.map(d=>d.penalty).reduce((d,c)=>d+c,0)}function J(i){switch(r.querySelectorAll(M(i)).length){case 0:throw new Error(`Can't select any node with this selector: ${M(i)}`);case 1:return!0;default:return!1}}function Q(i){i?.getAttribute||alert(JSON.stringify(i));let d=i.getAttribute("id");return d&&e.idName(d)?{name:"#"+Y(d,{isIdentifier:!0}),penalty:0,identifier:"id"}:null}function ee(i){return Array.from(i.attributes).filter(c=>e.attr(c.name,c.value)).map(c=>({name:"["+Y(c.name,{isIdentifier:!0})+'="'+Y(c.value)+'"]',penalty:.5,identifier:"attribute"}))}function te(i){return Array.from(i.classList).filter(e.className).map(c=>({name:"."+Y(c,{isIdentifier:!0}),penalty:1,identifier:"className"}))}function Le(i){let d=i.tagName.toLowerCase();return e.tagName(d)?{name:d,penalty:2,identifier:"tagName"}:null}function Ae(){return{name:"*",penalty:3,identifier:"any"}}function U(i){let d=i.parentNode;if(!d)return null;let c=d.firstChild;if(!c)return null;let m=0;for(;c&&(c.nodeType===Node.ELEMENT_NODE&&m++,c!==i);)c=c.nextSibling;return{index:m,outOf:d.childElementCount,penalty:4,identifier:"index"}}function H(i,d){return{name:i.name+`:nth-child(${d})`,penalty:i.penalty+1}}function K(i){return i.name!=="html"&&!i.name.startsWith("#")}function D(...i){let d=i.filter(q);return d.length>0?d:null}function q(i){return i!=null}function*W(i,d=[]){if(i.length>0)for(let c of i[0])yield*W(i.slice(1,i.length),d.concat(c));else yield d}function j(i){return Array.from(i).sort((d,c)=>V(d)-V(c))}function*le(i,d,c={counter:0,visited:new Map}){if(i.length>2&&i.length>e.optimizedMinLength)for(let m=1;m<i.length-1;m++){if(c.counter>e.maxNumberOfTries)return;c.counter+=1;let S=[...i];S.splice(m,1);let I=M(S);if(c.visited.has(I))return;J(S)&&ce(S,d)&&(yield S,c.visited.set(I,!0),yield*le(S,d,c))}}function ce(i,d){return r.querySelector(M(i))===input}let xe=/[ -,\.\/:-@\[-\^`\{-~]/,B=/[ -,\.\/:-@\[\]\^`\{-~]/,Re=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,X={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1};function Y(i,d={}){let c=Object.assign(Object.assign({},X),d);c.quotes!="single"&&c.quotes!="double"&&(c.quotes="single");let m=c.quotes=="double"?'"':"'",S=c.isIdentifier,I=i.charAt(0),v="",h=0,y=i.length;for(;h<y;){let L=i.charAt(h++),x=L.charCodeAt(0),a;if(x<32||x>126){if(x>=55296&&x<=56319&&h<y){let n=i.charCodeAt(h++);(n&64512)==56320?x=((x&1023)<<10)+(n&1023)+65536:h--}a="\\"+x.toString(16).toUpperCase()+" "}else c.escapeEverything?xe.test(L)?a="\\"+L:a="\\"+x.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(L)?a="\\"+x.toString(16).toUpperCase()+" ":L=="\\"||!S&&(L=='"'&&m==L||L=="'"&&m==L)||S&&B.test(L)?a="\\"+L:a=L;v+=a}return S&&(/^-[-\d]/.test(v)?v="\\-"+v.slice(1):/\d/.test(I)&&(v="\\3"+I+" "+v.slice(1))),v=v.replace(Re,function(L,x,a){return x&&x.length%2?L:(x||"")+a}),!S&&c.wrap?m+v+m:v}return{getElementProfileNodesInfo:o,generateSelectorFromNodesInfo:s}}function mr(t,{dataAttribute:e}={}){let r=jt(),o={seedMinLength:6,optimizedMinLength:t.target.id?2:10,threshold:2e3,attr:f=>f===e},s=r.getElementProfileNodesInfo(t.target,o);return console.log("Just FYI - this is how it can generate css selector:",r.generateSelectorFromNodesInfo(s,o)),s}function Xt(t,e){this.saveSelectedSelector=s=>{s.preventDefault(),s.stopPropagation(),console.log("Removing mouse over event listener from the selected element."),t.removeEventListener("mouseover",this.mouseOverEvent);let f=mr(s,{dataAttribute:"some-custom-strigo-attribute"});this.elementProfile=f||{};let E=t.getElementById("element-selector-overlay");E||console.error("Missing selector overlay element!"),t?.body?.removeChild(E),console.log("Selected element with elementProfile:",this.elementProfile),e.onElementProfileCreated(this.elementProfile)};function r(s,f){for(let E in f)s.style[E]=f[E]}this.move=(s,f,E=[])=>{if(f===s.target)return;let T=s.target;if(E.includes(T.id))return;let p={top:-window.scrollY,left:-window.scrollX},w=s.target;for(;w&&w!==t.body;)p.top+=w.offsetTop,p.left+=w.offsetLeft,w=w.offsetParent;let _=T.offsetWidth+2,M=T.offsetHeight+2,V={top:p.top-2+"px",left:p.left-2+"px",width:_+"px",height:M+"px"};r(f,V)},this.mouseOverEvent=s=>{let f=t.getElementById("element-selector-overlay");this.move(s,f,["#element-selector-overlay"]),s.target.addEventListener("click",this.saveSelectedSelector)},this.removeClickListenerFromHoveredElement=s=>{s.target.removeEventListener("click",this.saveSelectedSelector)};let o=t.createElement("div");o.setAttribute("id","element-selector-overlay"),o.setAttribute("style",`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: ${e.zIndex||2147483646};
      padding: 1px;
      position: fixed;
      background: rgba(105, 108, 191, 0.2);
      border: 2px dashed #696CBF;
      box-sizing: border-box;
      border-radius: 4px;
    `),console.log("Appending overlay selector element."),t.body.appendChild(o),t.addEventListener("mouseover",this.mouseOverEvent),t.addEventListener("mouseout",this.removeClickListenerFromHoveredElement)}var Zt=class{constructor(){this.config={}}init(){try{if(g.info("Initializing SDK..."),this.config.initialized){g.info("SDK was already initialized");return}St(),yt();let{webApiKey:e,subDomain:r,selectedWidgetFlavor:o}=tt();if(!e||!r||!o)throw new Error("Init data is missing");let s=qt(o);it({webApiKey:e,subDomain:r,selectedWidgetFlavor:s});let f=Ce(s);this.config.sdkType=f.init(),this.config.initialized=!0,g.info("Initialized SDK."),this.config.sdkType!=="CHILD"&&dt()&&this.setup()}catch(e){g.error("Could not initialize SDK",{err:e})}}async setup(e){try{if(g.info("Starting to setup SDK..."),this.config.isOpen||this.config.sdkType==="CHILD"){g.info("panel is already opened");return}if(!this.config.initialized)throw new Error("SDK was not initialized");let r=b(),{email:o,token:s,development:f=!1,version:E,openWidget:T=!0}={...r.user,...r,...e};if(!f&&(!o||!s))throw new Error("Setup data is missing");let p=await ct(s,f);if(p){let{loggingConfig:w,userAssessments:_}=p;g.debug("Configuration fetched from Strigo"),g.setup(w),wt(_)}st({user:{email:o,token:s},initSite:Xe(),development:f,version:E,loggingConfig:p?.loggingConfig}),this.config.configured=!0,g.info("Finished SDK setup."),T&&this.open()}catch(r){g.error("Could not setup SDK",{err:r})}}open(){try{if(g.info("Opening academy panel..."),!this.config.configured)throw new Error("SDK was not set up");if(this.config.isOpen||this.config.sdkType==="CHILD"){g.info("Panel is already opened");return}let e=b();gt({currentUrl:e.initSite.href,isPanelOpen:!0,isLoading:!0,widgetFlavor:e.selectedWidgetFlavor}),Ce(e.selectedWidgetFlavor).setup({version:e.version,development:e.development}),this.config.isOpen=!0,g.info("Opened academy panel.")}catch(e){g.error("Could not open academy panel",{err:e})}}shutdown(){try{if(g.info("Closing academy panel..."),this.config.sdkType==="CHILD"){window.parent.postMessage(JSON.stringify({messageType:"close"}),"*"),g.info("Notified parent frame to close academy panel.");return}if(!this.config.isOpen){g.info("Tried to close unopened academy panel");return}let e=Ce(Z());mt(),e.shutdown(),this.config.isOpen=!1,g.info("Closed academy panel.")}catch(e){g.error("Could not close academy panel",{err:e})}}destroy(){try{if(g.info("Destroying SDK..."),this.config.sdkType==="CHILD"){window.parent.postMessage(JSON.stringify({messageType:"destroy"}),"*"),g.info("Notified parent frame to destroy SDK.");return}lt(),ht(),Ot(),this.shutdown(),this.config={},g.info("Destroyed SDK.")}catch(e){g.error("Could not destroy SDK",{err:e})}}sendEvent(e){pt({eventName:e}),g.debug("sendEvent called",{eventName:e})}startElementSelector(){g.debug("startElementSelector called");function e(r){g.debug("onElementProfileCreated",{elementProfile:r})}Xt(window.document,{onElementProfileCreated:e,zIndex:9999999999})}},Qt=new Zt;window.Strigo=Qt;window.Strigo.init();})();
