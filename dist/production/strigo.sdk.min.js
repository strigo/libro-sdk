(()=>{var Me="strigo-sdk",be="strigo.io",Ge="localhost:3000",ze=["strigo-exercises"],Pe=["orig-iframe"],le=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"/></svg>
`,Fe=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M224 480c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25l192-192c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l169.4 169.4c12.5 12.5 12.5 32.75 0 45.25C240.4 476.9 232.2 480 224 480z"/></svg>
`,M="https://cdn.jsdelivr.net/gh/strigo/strigo-sdk";var ue="strigoChildIframe";function Zt(t){let e={};for(let[r,n]of t)e[r]=n;return e}function Qt(t){let r=new URLSearchParams(t).entries();return Zt(r)}function We(){let{host:t,pathname:e,href:r,origin:n,search:g}=window.location;return{host:t,pathName:e,href:r,origin:n,search:g,params:Qt(g)}}function K(t){let{subDomain:e,user:r,webApiKey:n,development:g}=t;return g?`http://${Ge}/academy/courses?token=${r.token.token}&webApiKey=${n}`:`https://${e}.${be}/academy/courses?token=${r.token.token}&webApiKey=${n}`}function He(t){let e=new URL(t);return e.searchParams.set(ue,"true"),e.toString()}function Ve(){return window.location.search.includes(ue)}function ke(){let t=new URL(window.location.href),e=new URLSearchParams(t.search);e.delete(ue),t.search=e.toString(),window.history.replaceState(window.history.state,"",t)}function Ke(){let t=document.getElementById(Me);return{webApiKey:t?.getAttribute("data-web-api-key")||"",subDomain:t?.getAttribute("data-subdomain")||"",selectedWidgetFlavor:t?.getAttribute("data-layout-flavor")||"dynamic"}}function Ue(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:e?`${M}@${e}/dist/production/styles/strigo.min.css`:`${M}@master/dist/production/styles/strigo.min.css`}function Ye(t,e){return t?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo-widget.css`:e?`${M}@${e}/dist/production/styles/strigo-widget.min.css`:`${M}@master/dist/production/styles/strigo-widget.min.css`}var Be=class{constructor(e){this.url=e?.url}setup(e){this.url=e.url}logToRemote(e,r,n){return fetch(this.url,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({level:e,message:r,context:n})}).then(g=>{g.ok||console.warn("Logging to Strigo failed",{result:g})}).catch(g=>{console.warn("Logging to Strigo failed",{err:g})})}logToConsole(e,r,n){let g=`${new Date().toISOString()} - ${r}`,l=n.err instanceof Error?{...n,err:{message:n.err.message,name:n.err.name,stack:n.err.stack}}:n;console[e](g,n?`
${JSON.stringify(l)}`:"")}getDefaultContext(){let e=v();if(!e)return{};let{user:r,subDomain:n,initSite:g,development:l,version:S,selectedWidgetFlavor:E}=e;return{token:r?.token.token,initSite:g?.href,subDomain:n,development:l,version:S,selectedWidgetFlavor:E}}log(e,r,n){let g={...this.getDefaultContext(),...n};try{this.url&&!v()?.development&&this.logToRemote(e,r,g),this.logToConsole(e,`Academy - ${r}`,g)}catch(l){console.log("Logging error:",{err:l})}}debug(e,r={}){this.log("debug",e,r)}info(e,r={}){this.log("info",e,r)}warn(e,r={}){this.log("warn",e,r)}error(e,r={}){this.log("error",e,r)}},s=new Be;function G(t,e){try{return JSON.parse(window[t].getItem(e))}catch(r){return s.error("get storage data error",{err:r}),null}}function z(t,e,r){try{return window[t].setItem(e,JSON.stringify(r)),r}catch(n){return s.error("setup storage error",{err:n}),null}}function fe(t,e,r,n){try{let g=G(t,e);if(!g)throw new Error("Can't find initial state");let l={...g,[r]:n};return window[t].setItem(e,JSON.stringify(l)),l}catch(g){return s.error("set storage value error",{err:g}),null}}function U(t,e){try{window[t].removeItem(e)}catch(r){s.error("clear storage error",{err:r})}}function v(){return G("localStorage","strigoConfig")}function $e(t){let e=v();return z("localStorage","strigoConfig",{...e,...t})}function Je(t){let e=v();return z("localStorage","strigoConfig",{...e,...t})}function je(t){return v()?.[t]}function qe(){U("localStorage","strigoConfig")}async function Xe(t,e){try{let n=await fetch(`${e?"http://localhost:3000":"https://app.strigo.io"}/api/internal/academy/v1/config`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`}});if(!n.ok)throw new Error(`Failed to fetch remote configuration: ${n.statusText}`);return(await n.json()).data}catch(r){return s.warn("Error fetching configuration from Strigo",{err:r}),null}}function Ze(t){return z("sessionStorage","strigoSession",t)}function pe(){return G("sessionStorage","strigoSession")}function Qe(){return pe()?.isPanelOpen}function _(){return pe()?.widgetFlavor}function et(t,e){return fe("sessionStorage","strigoSession",t,e)}function tt(t){return pe()?.[t]}function rt(){U("sessionStorage","strigoSession")}function B(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(t){return s.error("Get events storage error",{error:t}),null}}function ot(){try{let t=B();if(t)return s.debug("Events storage already exists"),t;let e={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),e}catch(t){return s.error("Init events storage error",{error:t}),null}}function nt(t){try{let e=B();if(!e)throw new Error("Can't find initial state");let r=JSON.stringify(e);if(e.events.push(t),window["localStorage"].setItem("strigoEvents",JSON.stringify(e)),_()==="overlay"){let n=new CustomEvent("overlay-widget-event",{bubbles:!0,detail:{key:"strigoEvents",oldValue:r,newValue:JSON.stringify(e)}});window.dispatchEvent(n)}return e}catch(e){return s.error("Push event to storage error",{error:e}),null}}function it(){try{let t=B();if(!t)throw new Error("Can't find events storage");let e=t.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),e}catch(t){return s.error("Pop event from storage error",{error:t}),null}}function he(){try{let t=B();if(!t)throw new Error("Can't find events storage");return t.events.pop()}catch(t){return s.error("Get event from storage error",{error:t}),null}}function st(){try{window["localStorage"].removeItem("strigoEvents")}catch(t){s.error("Clear events storage error",{error:t})}}function ye(){try{return JSON.parse(window["localStorage"].getItem("strigoAssessments"))}catch(t){return s.error("Get assessments storage error",{error:t}),null}}function gt(){try{let t=ye();if(t)return s.debug("Assessments storage already exists"),t;let e={assessments:[]};return window["localStorage"].setItem("strigoAssessments",JSON.stringify(e)),e}catch(t){return s.error("Init assessments storage error",{error:t}),null}}function ct(t){try{let e=t?{assessments:[...t]}:{assessments:[]};return window["localStorage"].setItem("strigoAssessments",JSON.stringify(e)),e}catch(e){return s.error("Assessments storage setup error",{error:e}),null}}function lt(){try{window["localStorage"].removeItem("strigoAssessments")}catch(t){s.error("Clear assessments storage error",{error:t})}}function $(){return document.getElementsByTagName("head")[0]}function dt(){document.open(),document.close()}function ut(){let t=document.createElement("div");return t.className="strigo-main",document.body.appendChild(t),t}function J(t){let{url:e,parentElement:r}=t,n=document.createElement("link");n.rel="stylesheet",n.href=e,r.appendChild(n)}function we(t){let{url:e,parentElement:r,classNames:n,id:g}=t,l=document.createElement("iframe");return l.classList.add(...n),l.id=g,l.src=e,r.appendChild(l),l}function mt(){location.reload()}function ft(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function St(){return ft()?[window.screen.width,window.screen.width]:[window.screen.width/2,window.screen.width]}function pt(){return ft()?[0,0]:[window.screen.width*.25,0]}function vt(){let t=new XMLHttpRequest;t.open("GET",window.document.location.href,!1),t.send(null);let r=t.getAllResponseHeaders().toLowerCase().split(`\r
`);for(let n of r)if(n.includes("x-frame-options")){let g=n.split(":");if(g&&g.length>1)return g[1].trim()!=="deny"}return!0}function tr(){let t=document.getElementById("strigo-widget"),e=t.classList.contains("slide-in");t.classList.toggle("slide-in"),setTimeout(()=>{let r=document.getElementById("strigo-arrow");r.innerHTML=e?Fe:le},300)}function Et(t){let e=document.createElement("div");e.className="strigo-arrow",e.id="strigo-arrow",e.innerHTML=le;let r=document.createElement("div");r.className="strigo-collapse-button",r.id="strigo-toggle",r.appendChild(e);let n=document.createElement("div");n.className="strigo-collapse-div",n.onclick=()=>{tr()},n.appendChild(r);let g=document.createElement("iframe");g.className="strigo-iframe",g.id="strigo-exercises",g.src=t;let l=document.createElement("div");return l.id="strigo-widget",l.appendChild(n),l.appendChild(g),document.body.appendChild(l),g}function ht(){document.getElementById("strigo-widget").remove()}function yt(){let t=document.getElementById("strigo-widget");t.classList.contains("slide-in")||t.classList.add("slide-in")}var h=typeof window!="undefined"?window:null,Oe=h===null,F=Oe?void 0:h.document,y="addEventListener",w="removeEventListener",Te="getBoundingClientRect",P="_a",T="_b",I="_c",j="horizontal",O=function(){return!1},rr=Oe?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var e=F.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length}).shift()+"calc",Ot=function(t){return typeof t=="string"||t instanceof String},Tt=function(t){if(Ot(t)){var e=F.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},f=function(t,e,r){var n=t[e];return n!==void 0?n:r},q=function(t,e,r,n){if(e){if(n==="end")return 0;if(n==="center")return t/2}else if(r){if(n==="start")return 0;if(n==="center")return t/2}return t},or=function(t,e){var r=F.createElement("div");return r.className="gutter gutter-"+e,r},nr=function(t,e,r){var n={};return Ot(e)?n[t]=e:n[t]=rr+"("+e+"% - "+r+"px)",n},ir=function(t,e){var r;return r={},r[t]=e+"px",r},sr=function(t,e){if(e===void 0&&(e={}),Oe)return{};var r=t,n,g,l,S,E,d;Array.from&&(r=Array.from(r));var R=Tt(r[0]),L=R.parentNode,Le=getComputedStyle?getComputedStyle(L):null,Ce=Le?Le.flexDirection:null,oe=f(e,"sizes")||r.map(function(){return 100/r.length}),ne=f(e,"minSize",100),ie=Array.isArray(ne)?ne:r.map(function(){return ne}),se=f(e,"maxSize",1/0),Ht=Array.isArray(se)?se:r.map(function(){return se}),Vt=f(e,"expandToMin",!1),D=f(e,"gutterSize",10),W=f(e,"gutterAlign","center"),ae=f(e,"snapOffset",30),kt=Array.isArray(ae)?ae:r.map(function(){return ae}),ge=f(e,"dragInterval",1),x=f(e,"direction",j),ce=f(e,"cursor",x===j?"col-resize":"row-resize"),Kt=f(e,"gutter",or),Ae=f(e,"elementStyle",nr),Ut=f(e,"gutterStyle",ir);x===j?(n="width",g="clientX",l="left",S="right",E="clientWidth"):x==="vertical"&&(n="height",g="clientY",l="top",S="bottom",E="clientHeight");function N(a,o,i,c){var m=Ae(n,o,i,c);Object.keys(m).forEach(function(u){a.style[u]=m[u]})}function Yt(a,o,i){var c=Ut(n,o,i);Object.keys(c).forEach(function(m){a.style[m]=c[m]})}function H(){return d.map(function(a){return a.size})}function Re(a){return"touches"in a?a.touches[0][g]:a[g]}function xe(a){var o=d[this.a],i=d[this.b],c=o.size+i.size;o.size=a/this.size*c,i.size=c-a/this.size*c,N(o.element,o.size,this[T],o.i),N(i.element,i.size,this[I],i.i)}function Bt(a){var o,i=d[this.a],c=d[this.b];!this.dragging||(o=Re(a)-this.start+(this[T]-this.dragOffset),ge>1&&(o=Math.round(o/ge)*ge),o<=i.minSize+i.snapOffset+this[T]?o=i.minSize+this[T]:o>=this.size-(c.minSize+c.snapOffset+this[I])&&(o=this.size-(c.minSize+this[I])),o>=i.maxSize-i.snapOffset+this[T]?o=i.maxSize+this[T]:o<=this.size-(c.maxSize-c.snapOffset+this[I])&&(o=this.size-(c.maxSize+this[I])),xe.call(this,o),f(e,"onDrag",O)(H()))}function _e(){var a=d[this.a].element,o=d[this.b].element,i=a[Te](),c=o[Te]();this.size=i[n]+c[n]+this[T]+this[I],this.start=i[l],this.end=i[S]}function $t(a){if(!getComputedStyle)return null;var o=getComputedStyle(a);if(!o)return null;var i=a[E];return i===0?null:(x===j?i-=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight):i-=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom),i)}function De(a){var o=$t(L);if(o===null||ie.reduce(function(u,p){return u+p},0)>o)return a;var i=0,c=[],m=a.map(function(u,p){var A=o*u/100,V=q(D,p===0,p===a.length-1,W),k=ie[p]+V;return A<k?(i+=k-A,c.push(0),k):(c.push(A-k),A)});return i===0?a:m.map(function(u,p){var A=u;if(i>0&&c[p]-i>0){var V=Math.min(i,c[p]-i);i-=V,A=u-V}return A/o*100})}function Jt(){var a=this,o=d[a.a].element,i=d[a.b].element;a.dragging&&f(e,"onDragEnd",O)(H()),a.dragging=!1,h[w]("mouseup",a.stop),h[w]("touchend",a.stop),h[w]("touchcancel",a.stop),h[w]("mousemove",a.move),h[w]("touchmove",a.move),a.stop=null,a.move=null,o[w]("selectstart",O),o[w]("dragstart",O),i[w]("selectstart",O),i[w]("dragstart",O),o.style.userSelect="",o.style.webkitUserSelect="",o.style.MozUserSelect="",o.style.pointerEvents="",i.style.userSelect="",i.style.webkitUserSelect="",i.style.MozUserSelect="",i.style.pointerEvents="",a.gutter.style.cursor="",a.parent.style.cursor="",F.body.style.cursor=""}function jt(a){if(!("button"in a&&a.button!==0)){var o=this,i=d[o.a].element,c=d[o.b].element;o.dragging||f(e,"onDragStart",O)(H()),a.preventDefault(),o.dragging=!0,o.move=Bt.bind(o),o.stop=Jt.bind(o),h[y]("mouseup",o.stop),h[y]("touchend",o.stop),h[y]("touchcancel",o.stop),h[y]("mousemove",o.move),h[y]("touchmove",o.move),i[y]("selectstart",O),i[y]("dragstart",O),c[y]("selectstart",O),c[y]("dragstart",O),i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.MozUserSelect="none",i.style.pointerEvents="none",c.style.userSelect="none",c.style.webkitUserSelect="none",c.style.MozUserSelect="none",c.style.pointerEvents="none",o.gutter.style.cursor=ce,o.parent.style.cursor=ce,F.body.style.cursor=ce,_e.call(o),o.dragOffset=Re(a)-o.end}}oe=De(oe);var C=[];d=r.map(function(a,o){var i={element:Tt(a),size:oe[o],minSize:ie[o],maxSize:Ht[o],snapOffset:kt[o],i:o},c;if(o>0&&(c={a:o-1,b:o,dragging:!1,direction:x,parent:L},c[T]=q(D,o-1===0,!1,W),c[I]=q(D,!1,o===r.length-1,W),Ce==="row-reverse"||Ce==="column-reverse")){var m=c.a;c.a=c.b,c.b=m}if(o>0){var u=Kt(o,x,i.element);Yt(u,D,o),c[P]=jt.bind(c),u[y]("mousedown",c[P]),u[y]("touchstart",c[P]),L.insertBefore(u,i.element),c.gutter=u}return N(i.element,i.size,q(D,o===0,o===r.length-1,W),o),o>0&&C.push(c),i});function Ne(a){var o=a.i===C.length,i=o?C[a.i-1]:C[a.i];_e.call(i);var c=o?i.size-a.minSize-i[I]:a.minSize+i[T];xe.call(i,c)}d.forEach(function(a){var o=a.element[Te]()[n];o<a.minSize&&(Vt?Ne(a):a.minSize=o)});function qt(a){var o=De(a);o.forEach(function(i,c){if(c>0){var m=C[c-1],u=d[m.a],p=d[m.b];u.size=o[c-1],p.size=i,N(u.element,u.size,m[T],u.i),N(p.element,p.size,m[I],p.i)}})}function Xt(a,o){C.forEach(function(i){if(o!==!0?i.parent.removeChild(i.gutter):(i.gutter[w]("mousedown",i[P]),i.gutter[w]("touchstart",i[P])),a!==!0){var c=Ae(n,i.a.size,i[T]);Object.keys(c).forEach(function(m){d[i.a].element.style[m]="",d[i.b].element.style[m]=""})}})}return{setSizes:qt,getSizes:H,collapse:function(o){Ne(d[o])},destroy:Xt,parent:L,pairs:C}},It=sr;var ar=`
<div class="circle-loader">
  <svg class="circular" viewBox="25 25 50 50">
  <circle
    class="path"
    cx="50"
    cy="50"
    r="20"
    fill="none"
    stroke-width="2"
    stroke-miterlimit="10"
  />
  </svg>
</div>
`;function Lt(){let t=document.createElement("div");t.className="strigo-loader",t.innerHTML=ar,document.body.appendChild(t)}function Ct(){let t=document.querySelector(".strigo-loader");return new Promise(e=>{let r=setInterval(()=>{t.style.opacity||(t.style.opacity="1");let n=parseFloat(t.style.opacity);n>0?t.style.opacity=(n-.1).toString():(t.style.pointerEvents="none",clearInterval(r),e())},200)})}function Ie(){let t=he();if(t){s.info("Posting event",t),document.getElementById("strigo-exercises").contentWindow.postMessage(t,"*");let r=it();t.eventName!==r.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:t,poppedEvent:r})}}function At(){for(;he();)Ie()}var X=function(t){let e=t.document,r=ye().assessments,n=function(){r.forEach(l=>{let{eventName:S,expectedResult:E,selector:d}=l,R=e.querySelector(d);(R?.innerText?.includes(E)||R?.value?.includes(E))&&t.Strigo.sendEvent(S)})},g=new MutationObserver(n);return g.observe(e,{subtree:!0,attributes:!0,attributeOldValue:!0,characterDataOldValue:!0,characterData:!0}),g};function cr(){document.getElementById("strigo-widget").classList.add("slide-in"),document.getElementById("strigo-widget").classList.add("loaded")}var _t=class{constructor(){this.onStrigoEventHandler=e=>{Q(e?.detail)}}init(){return s.info("overlay init called"),"OVERLAY"}setup({development:e,version:r}){s.info("overlay setup called"),J({parentElement:$(),url:Ye(e,r)});let n=Et(K(v()));this.initEventListeners(n),this.documentObserver=X(window)}shutdown(){s.info("overlay shutdown called"),this.removeEventListeners(),this.documentObserver.disconnect(),ht()}open(){yt()}initEventListeners(e){te(e,cr),ee(),window.addEventListener("overlay-widget-event",this.onStrigoEventHandler)}removeEventListeners(){Dt(),window.removeEventListener("overlay-widget-event",this.onStrigoEventHandler)}},Z=new _t;function Q({key:t,oldValue:e,newValue:r}){if(t!=="strigoEvents")return;let n=JSON.parse(r)?.events,g=JSON.parse(e)?.events;n.filter(({eventName:S})=>!g.some(({eventName:E})=>S===E)).length>0&&Ie()}function Mt(t){if(!(!t||!t.data))switch(t.data){case"close":{s.info("Shutdown message received"),window.Strigo?.shutdown();break}case"destroy":{s.info("Destroy message received"),window.Strigo?.destroy();break}case"challenge-success":{s.info("Challenge event success received"),_()==="overlay"&&Z.open();break}default:break}}function ee(){window.addEventListener("message",Mt,!1)}function Dt(){window.removeEventListener("message",Mt)}function te(t,e){t.addEventListener("load",async()=>{tt("isLoading")&&(e&&await e(),et("isLoading",!1)),At()})}function bt(t){let e=je("initSite")?.host;t.addEventListener("load",function(){X(t.contentWindow);try{this.contentWindow.location.host!==e&&window.Strigo.shutdown()}catch(r){s.error(r),window.Strigo.shutdown()}})}var Gt=class{init(){let e;return Ve()?(s.info("Child SDK window"),e="CHILD",window.dispatchEvent(new Event("strigo-opened")),ke()):(s.info("Parent SDK window"),e="PARENT"),e}setup({development:e,version:r}){s.info("iframe setup started"),dt(),J({parentElement:$(),url:Ue(e,r)}),Lt();let n=v(),g=ut(),l=we({parentElement:g,url:K(n),classNames:ze,id:"strigo-exercises"}),S=we({parentElement:g,url:He(n.initSite.href),classNames:Pe,id:"original-site"});It(["#strigo-exercises","#original-site"],{sizes:[25,75],maxSize:St(),minSize:pt(),gutterSize:2}),this.initEventListeners(l,S)}shutdown(){s.info("iframe shutdown called"),mt()}initEventListeners(e,r){te(e,Ct),bt(r),ee(),window.addEventListener("storage",Q)}},zt=new Gt;function Pt(t){return t&&t==="dynamic"?vt()?"iframe":"overlay":t}function re(t){let e=null;switch(t){case"iframe":{e=zt;break}case"overlay":{e=Z;break}default:throw s.error("Widget flavor is not supported",{widgetFlavor:t}),new Error(`Widget flavor ${t} is not supported`)}return e}var Ft=class{constructor(){this.config={}}init(){try{if(s.info("Initializing SDK..."),this.config.initialized){s.info("SDK was already initialized");return}ot(),gt();let{webApiKey:e,subDomain:r,selectedWidgetFlavor:n}=Ke();if(!e||!r||!n)throw new Error("Init data is missing");let g=Pt(n);$e({webApiKey:e,subDomain:r,selectedWidgetFlavor:g});let l=re(g);this.config.sdkType=l.init(),this.config.initialized=!0,s.info("Initialized SDK."),this.config.sdkType!=="CHILD"&&Qe()&&this.setup()}catch(e){s.error("Could not initialize SDK",{err:e})}}async setup(e){try{if(s.info("Starting to setup SDK..."),this.config.isOpen||this.config.sdkType==="CHILD"){s.info("panel is already opened");return}if(!this.config.initialized)throw new Error("SDK was not initialized");let r=v(),{email:n,token:g,development:l=!1,version:S,openWidget:E=!0}={...r.user,...r,...e};if(!l&&(!n||!g))throw new Error("Setup data is missing");let d=await Xe(g,l);if(d){let{loggingConfig:R,userAssessments:L}=d;s.debug("Configuration fetched from Strigo"),s.setup(R),ct(L)}Je({user:{email:n,token:g},initSite:We(),development:l,version:S,loggingConfig:d?.loggingConfig}),this.config.configured=!0,s.info("Finished SDK setup."),E&&this.open()}catch(r){s.error("Could not setup SDK",{err:r})}}open(){try{if(s.info("Opening academy panel..."),!this.config.configured)throw new Error("SDK was not set up");if(this.config.isOpen||this.config.sdkType==="CHILD"){s.info("Panel is already opened");return}let e=v();Ze({currentUrl:e.initSite.href,isPanelOpen:!0,isLoading:!0,widgetFlavor:e.selectedWidgetFlavor}),re(e.selectedWidgetFlavor).setup({version:e.version,development:e.development}),this.config.isOpen=!0,s.info("Opened academy panel.")}catch(e){s.error("Could not open academy panel",{err:e})}}shutdown(){try{if(s.info("Closing academy panel..."),this.config.sdkType==="CHILD"){window.parent.postMessage(JSON.stringify({messageType:"close"}),"*"),s.info("Notified parent frame to close academy panel.");return}if(!this.config.isOpen){s.info("Tried to close unopened academy panel");return}let e=re(_());rt(),e.shutdown(),this.config.isOpen=!1,s.info("Closed academy panel.")}catch(e){s.error("Could not close academy panel",{err:e})}}destroy(){try{if(s.info("Destroying SDK..."),this.config.sdkType==="CHILD"){window.parent.postMessage(JSON.stringify({messageType:"destroy"}),"*"),s.info("Notified parent frame to destroy SDK.");return}qe(),st(),lt(),this.shutdown(),this.config={},s.info("Destroyed SDK.")}catch(e){s.error("Could not destroy SDK",{err:e})}}sendEvent(e){nt({eventName:e}),s.debug("sendEvent called",{eventName:e})}},Wt=new Ft;window.Strigo=Wt;window.Strigo.init();})();
