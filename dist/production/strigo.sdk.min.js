(()=>{var Xe=Object.defineProperty;var Ze=(t,r)=>{for(var i in r)Xe(t,i,{get:r[i],enumerable:!0})};var d=typeof window!="undefined"?window:null,Q=d===null,D=Q?void 0:d.document,E="addEventListener",O="removeEventListener",Z="getBoundingClientRect",M="_a",h="_b",T="_c",H="horizontal",y=function(){return!1},Qe=Q?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var r=D.createElement("div");return r.style.cssText="width:"+t+"calc(9px)",!!r.style.length}).shift()+"calc",ve=function(t){return typeof t=="string"||t instanceof String},pe=function(t){if(ve(t)){var r=D.querySelector(t);if(!r)throw new Error("Selector "+t+" did not match a DOM element");return r}return t},u=function(t,r,i){var a=t[r];return a!==void 0?a:i},J=function(t,r,i,a){if(r){if(a==="end")return 0;if(a==="center")return t/2}else if(i){if(a==="start")return 0;if(a==="center")return t/2}return t},et=function(t,r){var i=D.createElement("div");return i.className="gutter gutter-"+r,i},tt=function(t,r,i){var a={};return ve(r)?a[t]=r:a[t]=Qe+"("+r+"% - "+i+"px)",a},rt=function(t,r){var i;return i={},i[t]=r+"px",i},nt=function(t,r){if(r===void 0&&(r={}),Q)return{};var i=t,a,c,v,U,F,l;Array.from&&(i=Array.from(i));var f=pe(i[0]),m=f.parentNode,x=getComputedStyle?getComputedStyle(m):null,w=x?x.flexDirection:null,I=u(r,"sizes")||i.map(function(){return 100/i.length}),R=u(r,"minSize",100),C=Array.isArray(R)?R:i.map(function(){return R}),L=u(r,"maxSize",1/0),Fe=Array.isArray(L)?L:i.map(function(){return L}),Be=u(r,"expandToMin",!1),N=u(r,"gutterSize",10),B=u(r,"gutterAlign","center"),W=u(r,"snapOffset",30),ke=Array.isArray(W)?W:i.map(function(){return W}),q=u(r,"dragInterval",1),z=u(r,"direction",H),X=u(r,"cursor",z===H?"col-resize":"row-resize"),Ve=u(r,"gutter",et),Se=u(r,"elementStyle",tt),Ke=u(r,"gutterStyle",rt);z===H?(a="width",c="clientX",v="left",U="right",F="clientWidth"):z==="vertical"&&(a="height",c="clientY",v="top",U="bottom",F="clientHeight");function b(o,e,n,s){var g=Se(a,e,n,s);Object.keys(g).forEach(function(S){o.style[S]=g[S]})}function He(o,e,n){var s=Ke(a,e,n);Object.keys(s).forEach(function(g){o.style[g]=s[g]})}function k(){return l.map(function(o){return o.size})}function ce(o){return"touches"in o?o.touches[0][c]:o[c]}function ge(o){var e=l[this.a],n=l[this.b],s=e.size+n.size;e.size=o/this.size*s,n.size=s-o/this.size*s,b(e.element,e.size,this[h],e.i),b(n.element,n.size,this[T],n.i)}function Je(o){var e,n=l[this.a],s=l[this.b];!this.dragging||(e=ce(o)-this.start+(this[h]-this.dragOffset),q>1&&(e=Math.round(e/q)*q),e<=n.minSize+n.snapOffset+this[h]?e=n.minSize+this[h]:e>=this.size-(s.minSize+s.snapOffset+this[T])&&(e=this.size-(s.minSize+this[T])),e>=n.maxSize-n.snapOffset+this[h]?e=n.maxSize+this[h]:e<=this.size-(s.maxSize-s.snapOffset+this[T])&&(e=this.size-(s.maxSize+this[T])),ge.call(this,e),u(r,"onDrag",y)(k()))}function ue(){var o=l[this.a].element,e=l[this.b].element,n=o[Z](),s=e[Z]();this.size=n[a]+s[a]+this[h]+this[T],this.start=n[v],this.end=n[U]}function je(o){if(!getComputedStyle)return null;var e=getComputedStyle(o);if(!e)return null;var n=o[F];return n===0?null:(z===H?n-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight):n-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),n)}function fe(o){var e=je(m);if(e===null||C.reduce(function(S,p){return S+p},0)>e)return o;var n=0,s=[],g=o.map(function(S,p){var G=e*S/100,V=J(N,p===0,p===o.length-1,B),K=C[p]+V;return G<K?(n+=K-G,s.push(0),K):(s.push(G-K),G)});return n===0?o:g.map(function(S,p){var G=S;if(n>0&&s[p]-n>0){var V=Math.min(n,s[p]-n);n-=V,G=S-V}return G/e*100})}function $e(){var o=this,e=l[o.a].element,n=l[o.b].element;o.dragging&&u(r,"onDragEnd",y)(k()),o.dragging=!1,d[O]("mouseup",o.stop),d[O]("touchend",o.stop),d[O]("touchcancel",o.stop),d[O]("mousemove",o.move),d[O]("touchmove",o.move),o.stop=null,o.move=null,e[O]("selectstart",y),e[O]("dragstart",y),n[O]("selectstart",y),n[O]("dragstart",y),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",o.gutter.style.cursor="",o.parent.style.cursor="",D.body.style.cursor=""}function Ye(o){if(!("button"in o&&o.button!==0)){var e=this,n=l[e.a].element,s=l[e.b].element;e.dragging||u(r,"onDragStart",y)(k()),o.preventDefault(),e.dragging=!0,e.move=Je.bind(e),e.stop=$e.bind(e),d[E]("mouseup",e.stop),d[E]("touchend",e.stop),d[E]("touchcancel",e.stop),d[E]("mousemove",e.move),d[E]("touchmove",e.move),n[E]("selectstart",y),n[E]("dragstart",y),s[E]("selectstart",y),s[E]("dragstart",y),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",e.gutter.style.cursor=X,e.parent.style.cursor=X,D.body.style.cursor=X,ue.call(e),e.dragOffset=ce(o)-e.end}}I=fe(I);var A=[];l=i.map(function(o,e){var n={element:pe(o),size:I[e],minSize:C[e],maxSize:Fe[e],snapOffset:ke[e],i:e},s;if(e>0&&(s={a:e-1,b:e,dragging:!1,direction:z,parent:m},s[h]=J(N,e-1===0,!1,B),s[T]=J(N,!1,e===i.length-1,B),w==="row-reverse"||w==="column-reverse")){var g=s.a;s.a=s.b,s.b=g}if(e>0){var S=Ve(e,z,n.element);He(S,N,e),s[M]=Ye.bind(s),S[E]("mousedown",s[M]),S[E]("touchstart",s[M]),m.insertBefore(S,n.element),s.gutter=S}return b(n.element,n.size,J(N,e===0,e===i.length-1,B),e),e>0&&A.push(s),n});function me(o){var e=o.i===A.length,n=e?A[o.i-1]:A[o.i];ue.call(n);var s=e?n.size-o.minSize-n[T]:o.minSize+n[h];ge.call(n,s)}l.forEach(function(o){var e=o.element[Z]()[a];e<o.minSize&&(Be?me(o):o.minSize=e)});function We(o){var e=fe(o);e.forEach(function(n,s){if(s>0){var g=A[s-1],S=l[g.a],p=l[g.b];S.size=e[s-1],p.size=n,b(S.element,S.size,g[h],S.i),b(p.element,p.size,g[T],p.i)}})}function qe(o,e){A.forEach(function(n){if(e!==!0?n.parent.removeChild(n.gutter):(n.gutter[O]("mousedown",n[M]),n.gutter[O]("touchstart",n[M])),o!==!0){var s=Se(a,n.a.size,n[h]);Object.keys(s).forEach(function(g){l[n.a].element.style[g]="",l[n.b].element.style[g]=""})}})}return{setSizes:We,getSizes:k,collapse:function(e){me(l[e])},destroy:qe,parent:m,pairs:A}},de=nt;function Ee(){return document.getElementsByTagName("head")[0]}function Oe(){document.open(),document.close()}function he(){let t=document.createElement("div");return t.className="strigo-main",document.body.appendChild(t),t}function ye(t){let{url:r,parentElement:i}=t,a=document.createElement("link");a.rel="stylesheet",a.href=r,i.appendChild(a)}function ee(t){let{url:r,parentElement:i,classNames:a,id:c}=t,v=document.createElement("iframe");v.classList.add(...a),v.id=c,v.src=r,i.appendChild(v)}function Te(){location.reload()}var Ie="strigo.io",Re="localhost:3000",Ce="https://cdn.jsdelivr.net/gh/strigo/strigo-sdk@latest/dist/production/styles/strigo.min.css",xe=["strigo-exercises"],we=["orig-iframe"];function it(t){let r={};for(let[i,a]of t)r[i]=a;return r}function Ae(){let{host:t,pathname:r,href:i,origin:a,search:c}=window.location;return{host:t,pathName:r,href:i,origin:a,search:c,params:st(c)}}function st(t){let i=new URLSearchParams(t).entries();return it(i)}function Ge(t){let{subDomain:r,token:i,webApiKey:a,development:c}=t;return c?`http://${Re}/libro/courses?token=${i.token}&webApiKey=${a}`:`https://${r}.${Ie}/libro/courses?token=${i.token}&webApiKey=${a}`}function _(t,r){try{return JSON.parse(window[t].getItem(r))}catch(i){return console.log(i),null}}function j(t,r,i){try{return window[t].setItem(r,JSON.stringify(i)),i}catch(a){return console.log(a),null}}function te(t,r,i,a){try{let c=_(t,r);if(!c)throw new Error("Can't find initial state");let v={...c,[i]:a};return window[t].setItem(r,JSON.stringify(v)),v}catch(c){return console.log(c),null}}function P(t,r){try{window[t].removeItem(r)}catch(i){console.log(i)}}function Le(){return _("localStorage","strigoConfig")}function Ne(t){return j("localStorage","strigoConfig",t)}function $(){return _("localStorage","strigoConfig")}function be(){P("localStorage","strigoConfig")}var se={};Ze(se,{clearSession:()=>ie,getSession:()=>Me,init:()=>re,isPanelOpen:()=>oe,setSessionValue:()=>St,setup:()=>ne});function re(){let t=_("sessionStorage","strigoSession");return t}function ne(t){return j("sessionStorage","strigoSession",t)}function oe(){return Me()?.isPanelOpen}function Me(){return _("sessionStorage","strigoSession")}function St(t,r){return te("sessionStorage","strigoSession",t,r)}function ie(){P("sessionStorage","strigoSession")}window.onunload=function(){P("sessionStorage","strigoSession")};function De(){try{let t=Y();if(t)return console.log("Events storage already exists"),t;let r={events:[]};return window["localStorage"].setItem("strigoEvents",JSON.stringify(r)),r}catch(t){return console.log("Init events storage error",{error:t}),null}}function Y(){try{return JSON.parse(window["localStorage"].getItem("strigoEvents"))}catch(t){return console.log("Get events storage error",{error:t}),null}}function Pe(t){try{let r=Y();if(!r)throw new Error("Can't find initial state");return r.events.push(t),window["localStorage"].setItem("strigoEvents",JSON.stringify(r)),r}catch(r){return console.log("Push event to storage error",{error:r}),null}}function Ue(){try{let t=Y();if(!t)throw new Error("Can't find events storage");let r=t.events.pop();return window["localStorage"].setItem("strigoEvents",JSON.stringify(t)),r}catch(t){return console.log("Pop event from storage error",{error:t}),null}}function ae(){try{let t=Y();if(!t)throw new Error("Can't find events storage");return t.events.pop()}catch(t){return console.log("Get event from storage error",{error:t}),null}}var le;(l=>{function r(){let f=ae();if(f){console.log("Posting event",f),window.frames[0].postMessage(f,"*");let m=Ue();f.eventName!==m.eventName&&console.error("Events storage error: popped event doesn't match new event",{newEvent:f,poppedEvent:m})}}function i(){for(;ae();)r()}function a({key:f,oldValue:m,newValue:x}){let w=JSON.parse(x)?.events,I=JSON.parse(m)?.events;w.filter(({eventName:C})=>!I.some(({eventName:L})=>C===L)).length>0&&r()}function c(){Le(),re(),De(),se&&oe()?l.SDKType="SUBSCRIBER":l.SDKType="HOST",console.log("init called")}l.init=c;function v(f){if(l.SDKType==="SUBSCRIBER")return;console.log("setup started");let{email:m,token:x,webApiKey:w,subDomain:I,development:R=!1}=f;if(!R&&(!m||!x||!w||!I)){console.log("Please provide setup data");return}Ne({email:m,initSite:Ae(),token:x,webApiKey:w,subDomain:I,development:R}),Oe(),ye({parentElement:Ee(),url:R?`http://localhost:${SDK_HOSTING_PORT}/styles/strigo.css`:Ce});let C=he();ee({parentElement:C,url:Ge($()),classNames:xe,id:"exercises"}),ee({parentElement:C,url:$().initSite.href,classNames:we,id:"original-site"}),de(["#exercises","#original-site"],{sizes:[25,75],minSize:450}),ne({currentUrl:$().initSite.href,isPanelOpen:!0}),i(),window.addEventListener("storage",a),console.log("setup finished")}l.setup=v;function U(){l.SDKType==="SUBSCRIBER"&&(be(),ie(),Te()),console.log("shutdown called")}l.shutdown=U;function F(f){Pe({eventName:f}),console.log("sendEvent called",{eventName:f})}l.sendEvent=F})(le||={});window.StrigoSDK=le;window.StrigoSDK.init();})();
